<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="51单片机学习笔记, RickyLove">
    <meta name="description" content="零.序基于郭天祥《新概念51单片机C语言教程》及B站江科大自动化协视频。
一.基础知识1.二极管1.1各种二极管led 长正短负

1.2二极管工作原理​        二极管是一个由Р型半导体和N型半导体形成的PN结，在其交界面两侧形成空">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>51单片机学习笔记 | RickyLove</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/favicon.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">RickyLove</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/favicon.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">RickyLove</div>
        <div class="logo-desc">
            
            stay hungry , stay foolish
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/6.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">51单片机学习笔记</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-01-19
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="零-序"><a href="#零-序" class="headerlink" title="零.序"></a>零.序</h1><p>基于郭天祥《新概念51单片机C语言教程》及B站江科大自动化协视频。</p>
<h1 id="一-基础知识"><a href="#一-基础知识" class="headerlink" title="一.基础知识"></a>一.基础知识</h1><h2 id="1-二极管"><a href="#1-二极管" class="headerlink" title="1.二极管"></a>1.二极管</h2><h3 id="1-1各种二极管"><a href="#1-1各种二极管" class="headerlink" title="1.1各种二极管"></a>1.1各种二极管</h3><p>led 长正短负</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%90%84%E7%A7%8D%E4%BA%8C%E6%9E%81%E7%AE%A1.png" alt="各种二极管"></p>
<h3 id="1-2二极管工作原理"><a href="#1-2二极管工作原理" class="headerlink" title="1.2二极管工作原理"></a>1.2二极管工作原理</h3><p>​        二极管是一个由Р型半导体和N型半导体形成的PN结，在其交界面两侧形成空间电荷层，并建有自建电场。当不存在外加电压时，由于PN结两边载流子浓度差产生扩散电流和自建电场所引起的漂移电流相等而处于电平衡状态。<br>​        当外界有正向电压偏置时，外界电场和自建电场的互相抑制作用使载流子的扩散电流增大引起正向电流。当外界有反向电压偏置时，外界电场和自建电场进一步加强，形成在一定反向电压范围内与反向偏置电压值无关的反向饱和电流。当外加的反向电压高到一定程度时,PN结空间电荷层中的电场强度达到临界值而产生载流子的倍增过程，进而产生大量电子空穴对，由此产生了数值很大的反向击穿电流，这称为二极管的击穿现象。</p>
<h2 id="2-电容"><a href="#2-电容" class="headerlink" title="2.电容"></a>2.电容</h2><h3 id="2-1各种电容"><a href="#2-1各种电容" class="headerlink" title="2.1各种电容"></a>2.1各种电容</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%90%84%E7%A7%8D%E7%94%B5%E5%AE%B9.png" alt="各种电容"></p>
<h3 id="2-2电容作用"><a href="#2-2电容作用" class="headerlink" title="2.2电容作用"></a>2.2电容作用</h3><p>应用于电源电路，实现旁路、去耦、滤波和储能作用。</p>
<p>旁路电容是为本地器件提供能量的储能器件，使稳压器的输出均匀化，降低负载需求。</p>
<p>去耦电容起到一个电池的作用，满足驱动电路电流的变化，避免相互间的耦合干扰。</p>
<p>滤波，一般来说通高频阻低频，电容越大，阻抗越小。</p>
<p>储能型电容通过整流器收集电荷，并将存储的能量通过变换器引线传送至电源的输出端。</p>
<h2 id="3-场效应管"><a href="#3-场效应管" class="headerlink" title="3.场效应管"></a>3.场效应管</h2><h3 id="3-1MOS管种类和结构"><a href="#3-1MOS管种类和结构" class="headerlink" title="3.1MOS管种类和结构"></a>3.1MOS管种类和结构</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/MOS%E7%AE%A1%E5%AE%9E%E7%89%A9%E5%9B%BE.png" alt="MOS管实物图"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/MOS%E7%AE%A1%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="MOS管结构图"></p>
<p>​       MOSFET 管可以被制造成增强型或耗尽型、P沟道或N沟道共4种类型，但实际应用的只有增强型的N沟道MOS管和增强型的Р沟道MOS管，所以通常提到NMOS和 PMOS指的就是这两种。对于这两种增强型MOS管，比较常用的是NMOS。原因是NMOS管导通电阻小，且容易制造。</p>
<h3 id="3-2MOS管导通特性"><a href="#3-2MOS管导通特性" class="headerlink" title="3.2MOS管导通特性"></a>3.2MOS管导通特性</h3><p>​        NMOS 管的特性是，VGs大于一定的值就会导通，适合用于源极接地时的情况（低端驱动)，只要栅极电压达到4～10V就可以导通。<br>​        PMOS 的特性是,VGs小于一定的值就会导通, 适合用于源极接Vcc时的情况(高端驱动)。</p>
<h2 id="4-光耦"><a href="#4-光耦" class="headerlink" title="4.光耦"></a>4.光耦</h2><h3 id="4-1光耦简介"><a href="#4-1光耦简介" class="headerlink" title="4.1光耦简介"></a>4.1光耦简介</h3><p>光电耦合器亦称光电隔离器，简称光耦，是开关电源电路中常用的器件。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9E%E7%89%A9%E5%9B%BE1.png" alt="实物图1"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9E%E7%89%A9%E5%9B%BE2.png" alt="实物图2"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="结构图"></p>
<h3 id="4-2光耦工作原理"><a href="#4-2光耦工作原理" class="headerlink" title="4.2光耦工作原理"></a>4.2光耦工作原理</h3><p>​       光耦以光为媒介传输电信号。它对输入、输出电信号有良好的隔离作用。<br>​       光耦合器一般由三部分组成: 光的发射、光的接收及信号放大。输入的电信号驱动发光二极管(LED)，使之发出一定波长的光，被光探测器接收而产生光电流，再经过进一步放大后输出。</p>
<h2 id="5-蜂鸣器"><a href="#5-蜂鸣器" class="headerlink" title="5.蜂鸣器"></a>5.蜂鸣器</h2><h3 id="5-1蜂鸣器介绍"><a href="#5-1蜂鸣器介绍" class="headerlink" title="5.1蜂鸣器介绍"></a>5.1蜂鸣器介绍</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%9C%82%E9%B8%A3%E5%99%A8.png" alt="蜂鸣器"></p>
<h3 id="5-2蜂鸣器结构原理"><a href="#5-2蜂鸣器结构原理" class="headerlink" title="5.2蜂鸣器结构原理"></a>5.2蜂鸣器结构原理</h3><p>(1）压电式蜂鸣器<br>        压电式蜂鸣器主要由多谐振荡器、压电蜂鸣片、阻抗匹配器及共鸣箱、外壳等组成。当接通电源后（1.5<del>15V直流工作电压)，多谐振荡器起振，输出1.5</del>～2.5kHz 的音频信号，阻抗匹配器推动压电蜂鸣片发声。</p>
<p>(2）电磁式蜂鸣器<br>        电磁式蜂鸣器由振荡器、电磁线圈、磁铁、振动膜片及外壳等组成。接通电源后，振荡器产生的音频电流信号通过电磁线圈，使电磁线圈产生磁场。振动膜片在电磁线圈和磁铁的相互作用下，周期性地振动发声。</p>
<p>​        压电式蜂鸣器和电磁式蜂鸣器又各有两种结构:有源型和无源型。</p>
<p>​        有源蜂鸣器内部带振荡源，所以只要一通电就会叫。而无源蜂鸣器内部不带振荡源,所以如果用直流信号驱动它时，无法令其鸣叫,必须用2kHz～5kHz的方波信号去驱动它。<br>​        无论是有源型还是无源型，都可以通过单片机控制驱动信号来使它发出不同音调的声音，驱动方波的频率越高，音调就越高;驱动方波频率越低，音调也就越低。</p>
<h2 id="6-继电器"><a href="#6-继电器" class="headerlink" title="6.继电器"></a>6.继电器</h2><h3 id="6-1继电器结构"><a href="#6-1继电器结构" class="headerlink" title="6.1继电器结构"></a>6.1继电器结构</h3><p>​        继电器是当输入量（如电压、电流、温度等）达到规定值时，使被控制的输出电路导通或断开的电器。它可分为电气量（如电流、电压、频率、功率等）继电器及非电气量（如温度、压力、速度等）继电器两大类。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%BB%A7%E7%94%B5%E5%99%A8%E5%AE%9E%E7%89%A9%E5%9B%BE1.png" alt="继电器实物图1"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%BB%A7%E7%94%B5%E5%99%A8%E5%AE%9E%E7%89%A9%E5%9B%BE2.png" alt="继电器实物图2"></p>
<h3 id="6-2继电器原理特性"><a href="#6-2继电器原理特性" class="headerlink" title="6.2继电器原理特性"></a>6.2继电器原理特性</h3><p>​        继电器是一种电子控制器件，它具有控制系统(又称输入回路）和被控制系统（又称输出回路)，通常应用于自动控制电路中，它实际上是用较小的电流去控制较大电流的一种“自动开关”。故在电路中起着自动调节、安全保护、转换电路等作用。</p>
<h2 id="7-直流稳压电源"><a href="#7-直流稳压电源" class="headerlink" title="7.直流稳压电源"></a>7.直流稳压电源</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%9B%B4%E6%B5%81%E7%A8%B3%E5%8E%8B%E7%94%B5%E6%BA%90%E5%8E%9F%E7%90%86%E6%A1%86%E5%9B%BE.png" alt="直流稳压电源原理框图"></p>
<p>​        直流稳压电源是将交流电转变为稳定的、输出功率符合要求的直流电的设备。直流稳压电源通常由电源变压器、整流电路、滤波电路和稳压电路四部分组成。</p>
<p>其各部分的作用如下:<br>①电源变压器——将交流市电电压（220V)变换为符合整流需要的数值。<br>②整流电路——将交流电压变换为单向脉动直流电压。整流是利用二极管的单向导电性来实现的。<br>③滤波电路——将脉动直流电压中交流分量滤除，形成平滑的直流电压。滤波可利用电容、电感或电阻-电容来实现。<br>④稳压电路——其作用是当交流电网电压波动或负载变化时，保证输出直流电压稳定。简单的稳压电路可采用稳压管来实现，在稳压性能要求高的场合，可采用串联反馈式稳压电路（它包括基准电压、采样电路、放大电路和调整管等组成部分）。</p>
<h3 id="7-1整流电路"><a href="#7-1整流电路" class="headerlink" title="7.1整流电路"></a>7.1整流电路</h3><p>​       整流电路的功能是利用二极管的单向导电性将正弦交流电压转换成单向脉动电压。整流电路有单相整流和三相整流，有半波整流、全波整流、桥式整流等。<br>​       下面分析整流电路时，为叙述简单，把二极管当做理想元件来处理，即认为它的正向导通电阻为零，而反向电阻为无穷大。</p>
<h4 id="7-1-1单相桥式整流电路"><a href="#7-1-1单相桥式整流电路" class="headerlink" title="7.1.1单相桥式整流电路"></a>7.1.1单相桥式整流电路</h4><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8D%95%E7%9B%B8%E6%A1%A5%E5%BC%8F%E6%95%B4%E6%B5%81%E7%94%B5%E8%B7%AF.png" alt="单相桥式整流电路"></p>
<p>​        在电源电压uz的正、负半周内（设a端为正、b端为负时是正半周)电流通路用图中实线和虚线箭头表示。负载R上的电压uo的波形如图所示。电流的波形i。与u的波形相同。显然，它们都是单方向的全波脉动波形。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8D%95%E7%9B%B8%E6%A1%A5%E5%BC%8F%E6%95%B4%E6%B5%81%E7%94%B5%E8%B7%AF%E6%B3%A2%E5%BD%A2%E5%9B%BE.png" alt="单相桥式整流电路波形图"></p>
<h4 id="7-1-2指标"><a href="#7-1-2指标" class="headerlink" title="7.1.2指标"></a>7.1.2指标</h4><p>输出电压的平均值<img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%AC%E5%BC%8F1.png" alt="公式1"></p>
<p>直流电流</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%AC%E5%BC%8F2.png" alt="公式2"></p>
<p>流经每个二极管的平均电流</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%AC%E5%BC%8F3.png" alt="公式3"></p>
<p>二极管承受的最大反向电压</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%AC%E5%BC%8F4.png" alt="公式4"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%B8%B8%E8%A7%81%E6%95%B4%E6%B5%81%E7%94%B5%E8%B7%AF%E5%88%97%E8%A1%A8.png" alt="常见整流电路列表"></p>
<h3 id="7-2滤波电路"><a href="#7-2滤波电路" class="headerlink" title="7.2滤波电路"></a>7.2滤波电路</h3><h4 id="7-2-1电容滤波电路"><a href="#7-2-1电容滤波电路" class="headerlink" title="7.2.1电容滤波电路"></a>7.2.1电容滤波电路</h4><p>​        电容滤波电路是最简单的滤波器，它是在整流电路的负载上并联一个电容C。电容为带有正、负极性的大容量电容器，如电解电容、钼电容等。<br>​        电容滤波是通过电容器的充电、放电来滤掉交流分量。图中，虚线波形为桥式整流的波形。并入电容C后，在u2&gt;0时，D1，D3;导通，D2，D4截止，电源在向R供电的同时，又向C充电储能，由于充电时间常数很小(绕组电阻和二极管的正向电阻都很小），充电很快，输出电压uo随u2上升，当uc&#x3D;√2u2,后，u2开始下降，u2&lt;uc，t1<del>t2时段内，D1</del>D4全部反偏截止，由电容C向RL放电，由于放电时间常数较大，放电较慢，输出电压uo随uc按指数规律缓慢下降，如图中的ab实线段。b点以后，负半周电压 u2&gt; uc，D1，D3,截止，D2，D4导通，C又被充电至c点，充电过程形成uo&#x3D;u2的波形为bc实线段。c点以后，u2&lt;uc，D1~D4又截止，C又放电，如此不断的充电、放电，使负载获得如图中实线所示的u波形。由波形可见，桥式整流接电容滤波后，输出电压的脉动程度大大减小。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%B5%E5%AE%B9%E6%BB%A4%E6%B3%A2.png" alt="电容滤波"></p>
<h3 id="7-3稳压电路"><a href="#7-3稳压电路" class="headerlink" title="7.3稳压电路"></a>7.3稳压电路</h3><h4 id="7-3-1并联型稳压电路"><a href="#7-3-1并联型稳压电路" class="headerlink" title="7.3.1并联型稳压电路"></a>7.3.1并联型稳压电路</h4><p>​        并联型稳压电路是最简单的一种稳压电路。主要用于对稳压要求不高的场合，有时也作为基准电压源。因其稳压管Dz与负载电阻R并联而得名。</p>
<p>​        引起电压不稳定的原因是交流电源电压的波动和负载电流的变化，而稳压管能够稳压的原理在于稳压管具有很强的电流控制能力。当保持负载R不变，Ui因交流电源电压增大而增大时，负载电压Uo也要增大，稳压管的电流急剧增大，因此电阻R上的压降急剧增加，以抵偿Ui的增加，从而使负载电压Uo保持近似不变。相反，Ui因交流电源电压降低而降低时,稳压过程与上述过程相反。<br>​        如果保持电源电压不变，负载电流Io增大时，电阻R上的压降也增大，负载电压Uo因而下降，稳压管电流Iz急剧减小，从而补偿了Io的增大，使得通过电阻R的电流和电阻上的压降保持近似不变，因此负载电压Uo也就近似稳定不变。当负载电流减小时，稳压过程相反。<br><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%A8%B3%E5%8E%8B%E7%AE%A1%E7%A8%B3%E5%8E%8B%E7%94%B5%E8%B7%AF.png" alt="稳压管稳压电路"></p>
<h3 id="7-4集成稳压模块的使用"><a href="#7-4集成稳压模块的使用" class="headerlink" title="7.4集成稳压模块的使用"></a>7.4集成稳压模块的使用</h3><h4 id="7-4-1三段固定式集成稳压模块实物图"><a href="#7-4-1三段固定式集成稳压模块实物图" class="headerlink" title="7.4.1三段固定式集成稳压模块实物图"></a>7.4.1三段固定式集成稳压模块实物图</h4><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%89%E7%AB%AF%E5%9B%BA%E5%AE%9A%E5%BC%8F%E9%9B%86%E6%88%90%E7%A8%B3%E5%8E%8B%E6%A8%A1%E5%9D%97%E5%AE%9E%E7%89%A9%E5%9B%BE.png" alt="三端固定式集成稳压模块实物图"></p>
<h4 id="7-4-2三段固定式集成稳压模块"><a href="#7-4-2三段固定式集成稳压模块" class="headerlink" title="7.4.2三段固定式集成稳压模块"></a>7.4.2三段固定式集成稳压模块</h4><p>​       三端固定集成稳压模块有三个端子:输入端Ui、输出端Uo,和公共端COM。输入端接整流滤波电路，输出端接负载，公共端接输入、输出的公共连接点。其内部由采样、基准、放大、调整和保护等电路组成。保护电路具有过流、过热及短路保护功能。<br>​        图为三端集成稳压器LM7805和LM7905作为固定输出电压的典型应用。正常工作时，输入、输出电压差为2~3V。C1为输入稳定电容，其作用是减小纹波、消振、抑制高频和脉冲干扰，它一般为0.1～1uF。C2为输出稳定电容，其作用是改善负载的瞬态响应，它一般为1uF。使用三端稳压器时要根据输出电流的大小选择加散热器，否则会由于过热而无法工作到额定电流。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%B8%E5%9E%8B%E5%BA%94%E7%94%A8.png" alt="典型应用"></p>
<h3 id="7-5串联开关型稳压电源"><a href="#7-5串联开关型稳压电源" class="headerlink" title="7.5串联开关型稳压电源"></a>7.5串联开关型稳压电源</h3><h4 id="7-5-1串联开关型稳压电源工作原理"><a href="#7-5-1串联开关型稳压电源工作原理" class="headerlink" title="7.5.1串联开关型稳压电源工作原理"></a>7.5.1串联开关型稳压电源工作原理</h4><p>​       串联反馈式稳压电路由于调整管工作在线性区，因此其管耗大、电源效率较低(40%～60%)，有时还要配备庞大的散热装置。而串联开关型稳压电路调整管工作在开关状态，其具有管耗小、效率高（80%~90%)、稳压范围宽、滤波效果好等优点。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%BC%80%E5%85%B3%E5%9E%8B%E7%A8%B3%E5%8E%8B%E7%94%B5%E6%BA%90%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="开关型稳压电源原理图"></p>
<h4 id="7-5-2串联开关型稳压电源工作过程"><a href="#7-5-2串联开关型稳压电源工作过程" class="headerlink" title="7.5.2串联开关型稳压电源工作过程"></a>7.5.2串联开关型稳压电源工作过程</h4><p>​        开关型稳压电源电路原理框图如图所示。它是由调整管T、滤波电路LC、脉宽调制电路（PWM)和采样电路等组成。当ub为高电平时，调整管T饱和导通，输入电压Ui经滤波电感L加在滤波电容C和负载RL两端，在此期间，iL增大，L和C储能，二极管D反偏截止。当ub为低电平时，调整管T由导通变为截止，电感电流iL不能突变，iL经RL和续流二极管D衰减而释放能量，此时C也向RL放电，因此RL两端仍能获得连续的输出电压。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%B3%A2%E5%BD%A2.png" alt="波形"></p>
<p>​        图中tob是调整管T的导通时间，toff是调整管T的截止时间，T&#x3D;ton+toff是开关转换周期。显然，由于调整管T的导通与截止，使输入的直流电压Ui变成高频矩形脉冲电压Ue( Ud)，经LC滤波得到输出电压。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%AC%E5%BC%8F5.png" alt="公式5"></p>
<p>​       式中，q &#x3D; ton&#x2F;T称为脉冲波形的占空比，即一个周期持续脉冲时间ton与周期T之比值。由此可见，对于一定的Ui值，通过调节占空比即可调节输出电压Uo。<br>​       上图电路是通过保持控制信号的周期T不变，而改变导通时间to来调节输出电压Uo的大小，这种电路称为脉宽调制型开关稳压电源（PWM);若保持控制信号的脉宽不变，只改变信号的周期T，同样也能使输出电压Uo发生变化,这就是频率调制型开关电源(PFM);若同时改变导通时间 ton和周期T，称为混合性开关稳压电源。</p>
<h4 id="7-5-3稳压原理"><a href="#7-5-3稳压原理" class="headerlink" title="7.5.3稳压原理"></a>7.5.3稳压原理</h4><p>​        当输入电压波动或负载电流改变时，都将引起输出电压Uo的改变，在上图中，由于负反馈作用，电路能自动调整而使Uo基本维持不变。稳压过程如下:<br>当Ui↓→Uo↓→uf ↓ (uf&lt;Uref）一uA为正值→ue输出高电平变宽(ton)↑一Uo↑。</p>
<p>当Ui↑→Uo↑ →uf↑t (uf&gt;Uref）→uA为负值→ue输出高电平变窄(ton)↓→Uo↓。</p>
<p>​        此时，uT，uB，uE的波形如图所示。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%B3%A2%E5%BD%A22.png" alt="波形2"></p>
<h2 id="8-直流电机"><a href="#8-直流电机" class="headerlink" title="8.直流电机"></a>8.直流电机</h2><h3 id="8-1直流电机"><a href="#8-1直流电机" class="headerlink" title="8.1直流电机"></a>8.1直流电机</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%9B%B4%E6%B5%81%E7%94%B5%E6%9C%BA%E5%AE%9E%E7%89%A9%E5%9B%BE.png" alt="直流电机实物图"></p>
<h3 id="8-2直流电机概述"><a href="#8-2直流电机概述" class="headerlink" title="8.2直流电机概述"></a>8.2直流电机概述</h3><p>​        电动机简称电机，是使机械能与电能相互转换的机械，直流电机把直流电能变为机械能。激磁绕组及其所包围的铁芯组成的磁极为定子，带换向单元的电枢绕组和电枢铁芯结合构成直流电机的转子。</p>
<h3 id="8-3直流电机基本工作原理"><a href="#8-3直流电机基本工作原理" class="headerlink" title="8.3直流电机基本工作原理"></a>8.3直流电机基本工作原理</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%9B%B4%E6%B5%81%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="直流电机工作原理图"></p>
<p>​        从以上可以看到，要使线圈按照一定的方向旋转，关键问题是当导体从一个磁极范围转到另一个异性磁极范围时(也就是导体经过中性面后),导体中电流的方向也要同时改变，换向器和电刷就是完成这一任务的装置。许多线圈牢固地嵌在转子铁芯槽中，当导体中通过电流在磁场中因受力而转动时，就带动整个转子旋转，这就是直流电机的基本工作原理。</p>
<h3 id="8-4直流电机的驱动"><a href="#8-4直流电机的驱动" class="headerlink" title="8.4直流电机的驱动"></a>8.4直流电机的驱动</h3><p>​        用单片机控制直流电机时，需要加驱动电路，为直流电机提供足够大的驱动电流。通常有以下几种驱动电路:三极管电流放大驱动电路、电机专用驱动模块（如L298）和达林顿驱动器等。如果是驱动单个电机，并且电机的驱动电流不大时，我们可用三极管搭建驱动电路。如果电机所需要的驱动电流较大，可直接选用市场上现成的电机专用驱动模块。如果是读者自己学习电机原理及电路驱动原理使用，建议选用达林顿驱动器，它实际上是一个集成芯片，单块芯片同时可驱动8个电机，每个电机由单片机的一个IIO口控制，当需要调节直流电机转速时，使单片机的相应IO口输出不同占空比的PWM波形即可。<br>​        PWM是英文Pulse Width Modulation(脉冲宽度调制)的缩写，它是按一定规律改变脉冲序列的脉冲宽度，以调节输出量和波形的一种调制方式，我们在控制系统中最常用的是矩形波PWM信号，在控制时需要调节 PWM波的占空比。<br>​        当用单片机IO口输出PWM信号时，可采用以下三种方法:<br>(1）利用软件延时。当高电平延时时间到时，对IO口电平取反变成低电平，然后再延时;当低电平延时时间到时，再对该IO口电平取反，如此循环就可得到PWM信号。<br>(2）利用定时器。控制方法同上，只是在这里利用单片机的定时器来定时进行高、低电平的翻转，而不用软件延时。<br>(3)   利用单片机自带的PWM控制器。STC12系列单片机自身带有PWM控制器，STC89系列单片机无此功能，其他型号的很多单片机也带有PWM控制器，如PIC单片机、AVR单片机等。</p>
<h2 id="9-步进电机"><a href="#9-步进电机" class="headerlink" title="9.步进电机"></a>9.步进电机</h2><h3 id="9-1步进电机实物图"><a href="#9-1步进电机实物图" class="headerlink" title="9.1步进电机实物图"></a>9.1步进电机实物图</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%AE%9E%E7%89%A9%E5%9B%BE.png" alt="步进电机实物图"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E8%A7%A3%E5%89%96%E5%9B%BE.png" alt="步进电机解剖图"></p>
<h3 id="9-2步进电机概述"><a href="#9-2步进电机概述" class="headerlink" title="9.2步进电机概述"></a>9.2步进电机概述</h3><p>​        步进电机是将电脉冲信号转变为角位移或线位移的开环控制元件。在非超载情况下，电机的转速、停止的位置只取决于脉冲信号的频率和脉冲数，而不受负载变化的影响，即给电机加一个脉冲信号，电机则转过一个步距角。这一线性关系的存在，加上步进电机只有周期性的误差而无累积误差等特点，使得步进电机在速度、位置等控制领域的控制操作非常简单。虽然步进电机应用广泛，但它并不像普通的直流和交流电机那样在常规状态下使用，它必须由双环形脉冲信号、功率驱动电路等组成控制系统方可使用。</p>
<p>​        步进电机分类<br>(1）永磁式（PM)。一般为二相，转矩和体积较小，步距角一般为7.5°或15°。<br>(2）反应式(VR)。一般为三相，可实现大转矩输出，步距角一般为1.5°，但噪声和振动都很大。<br>(3）混合式（HB)。指混合了永磁式和反应式的优点。它又分为二相和五相，二相步距角一般为1.8°，而五相步距角一般为0.72°。这种步进电机的应用最为广泛。</p>
<h3 id="9-3步进电机工作原理"><a href="#9-3步进电机工作原理" class="headerlink" title="9.3步进电机工作原理"></a>9.3步进电机工作原理</h3><p>​        步进电机是一种将电脉冲转换成相应角位移或线位移的电磁机械装置。它具有快速启、停能力，在电机的负荷不超过它能提供的动态转矩时，可以通过输入脉冲来控制它在一瞬间的启动或停止。步进电机的步距角和转速只和输入的脉冲频率有关，和环境温度、气压、振动无关，也不受电网电压的波动和负载变化的影响。因此，步进电机多应用在需要精确定位的场合。<br>(1）工作原理<br>​        步进电机有三线式、五线式和六线式，但其控制方式均相同，都要以脉冲信号电流来驱动。假设每旋转一圈需要200个脉冲信号来励磁，可以计算出每个励磁信号能使步进电机前进1.8°，其旋转角度与脉冲的个数成正比。步进电动机的正、反转由励磁脉冲产生的顺序来控制。六线式四相步进电机是比较常见的，它的控制等效电路如图21.2.8所示。它有4条励磁信号引线A，A，B，B，通过控制这4条引线上励磁脉冲产生的时刻，即可控制步进电机的转动。每出现一个脉冲信号，步进电机只走一步。因此，只要依序不断送出脉冲信号，步进电机就能实现连续转动。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E6%8E%A7%E5%88%B6%E7%AD%89%E6%95%88%E7%94%B5%E8%B7%AF.png" alt="步进电机控制等效电路"></p>
<p>（2）励磁方式</p>
<p>​         步进电机的励磁方式分为全步励磁和半步励磁两种。其中全步励磁又有一相励磁和二相励磁之分;半步励磁又称一-二相励磁。假设每旋转一圈需要200个脉冲信号来励磁，可以计算出每个励磁信号能使步进电动机前进1.8°，简要介绍如下。<br>1.一相励磁——在每一瞬间，步进电机只有一个线圈导通。每送一个励磁信号，步进电机旋转1.8°，这是三种励磁方式中最简单的一种。<br>其特点是:精确度好、消耗电力小，但输出转矩最小，振动较大。如果以该方式控制步进电机正转，对应的励磁顺序如下表所示。若励磁信号反向传送，则步进电机反转。表中的1和0表示送给电机的高电平和低电平。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%80%E7%9B%B8%E5%8A%B1%E7%A3%81%E9%A1%BA%E5%BA%8F%E8%A1%A8.png" alt="一相励磁顺序表"></p>
<p>2.二相励磁——在每一瞬间，步进电动机有两个线圈同时导通。每送一个励磁信号，步进电机旋转1.8°。其特点是:输出转矩大，振动小，因而成为目前使用最多的励磁方式。如果以该方式控制步进电机正转，对应的励磁顺序见下表。若励磁信号反向传送，则步进电机反转。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%BA%8C%E7%9B%B8%E5%8A%B1%E7%A3%81%E9%A1%BA%E5%BA%8F%E8%A1%A8.png" alt="二相励磁顺序表"></p>
<p>3.—-二相励磁——为一相励磁与二相励磁交替导通的方式。每送一个励磁信号，步进电机旋转0.9°。<br>其特点是:分辨率高，运转平滑，故应用也很广泛。如果以该方式控制步进电机正转，对应的励磁顺序见下表。若励磁信号反向传送，则步进电机反转。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%80%E4%BA%8C%E7%9B%B8%E5%8A%B1%E7%A3%81%E9%A1%BA%E5%BA%8F%E8%A1%A8.png" alt="一二相励磁顺序表"></p>
<h3 id="9-4步进电机驱动"><a href="#9-4步进电机驱动" class="headerlink" title="9.4步进电机驱动"></a>9.4步进电机驱动</h3><p>​        步进电机的驱动可以选用专用的电机驱动模块，如 L298，FT5754等，这类驱动模块接口简单，操作方便，它们既可驱动步进电机，也可驱动直流电机。除此之外，还可利用三极管自己搭建驱动电路。另外，还有一种方法就是使用达林顿驱动器ULN2803，该芯片单片最多可一次驱动八线步进电机，当然如果只有四线或六线制的也是没有问题的。</p>
<h3 id="9-5步进电机使用常见问题"><a href="#9-5步进电机使用常见问题" class="headerlink" title="9.5步进电机使用常见问题"></a>9.5步进电机使用常见问题</h3><p>(1）步进电机使用时出现振动大、失步或有声不转动等现象，为什么?<br>        步进电机与普通交流电机有很大的差别，振动大或失步是常见的现象。产生的原因或解决方法有以下两点。<br>①控制脉冲——频率低速时是否处在共振点上（每个型号电机不同)，高速时是否采用梯形或其他曲线加速，控制脉冲频率有无跳动（部分PLC机型)。<br>解决方法:调整控制脉冲频率或采用步进伺服专用控制器。<br>②驱动器——电机低速时，振动或失步，高速时正常;驱动电压过高。电机低速时正常，高速时失步;驱动电压过低。电机长时间低速运转无发热现象（电机正常工作时可高达80～90℃);驱动电流过小。电机工作时过热;驱动电流过大。<br>解决方法:调节驱动器电流、驱动电压或更换驱动器。</p>
<p>(2）步进电机控制为什么要采用梯形或其他加速方法?</p>
<p>​        步进电机起步速度根据电机不同一般在150~250r&#x2F;min，如果希望高于此速度运转就必须先用起步以下速度起步，逐渐加速至最高速度，运行一定距离后再逐渐减速至起步速度以下方可停止，否则会出现高速上不去或失步的现象。常见加速方法有分级加速、梯形加速和S字加速等。</p>
<p>(3）步进电机的外表温度允许达到多少?</p>
<p>​        步进电机温度过高会使电机的磁性材料退磁，从而导致力矩下降及失步，因此电机外表允许的最高温度取决于不同电机磁性材料的退磁点。一般来讲，磁性材料的退磁点都在130℃以上，有的甚至高达200℃以上，所以步进电机外表温度在80~90℃完全正常。</p>
<p>(4）为什么步进电机的力矩会随转速的升高而下降?</p>
<p>​        当步进电机转动时，电机各相绕组的电感将形成一个反向电动势，频率越高，反向电动势越大。在它的作用下，电机随频率（或速度）的增大而相电流减小，从而导致力矩下降。</p>
<p>(5)  为什么步进电机低速时可以正常运转，但若高于一定速度就无法启动并伴有啸叫声?</p>
<p>​        步进电机有一个技术参数——空载启动频率，即步进电机在空载情况下能够正常启动的脉冲频率。如果脉冲频率高于该值，电机不能正常启动，可能发生失步或堵转。在有负载的情况下，启动频率应更低。如果要使电机达到高速转动，脉冲频率应该有加速过程，即启动频率较低，然后按一定加速度升到所希望的高频（电机转速从低速升到高速)。</p>
<p>(6）如何克服两相混合式步进电机在低速运转时的振动和噪声?<br>        步进电机低速转动时振动和噪声大是其固有的缺点，一般可采用以下方法来克服:①如步进电机正好工作在共振区，可通过改变减速比等机械传动避开共振区。②采用带有细分功能的驱动器，这是最常用、最简便的方法。③换成步距角更小的步进电机，如三相或五相步进电机。④换成交流伺服电机，几乎可以完全克服振动和噪声，但成本较高。⑤在电机轴上加磁性阻尼器，市场上已有这种产品，但机械结构改变较大。</p>
<p>(7）细分驱动器的细分数是否能代表精度?</p>
<p>​        步进电机的细分技术实质上是一种电子阻尼技术（请参考有关文献)，其主要目的是减弱或消除步进电机的低频振动，提高电机的运转精度，它只是细分技术的一个附带功能。比如对于步距角为1.8°的两相混合式步进电机，如果细分驱动器的细分数设置为4，那么电机的运转分辨率为每个脉冲0.45°，电机的精度能否达到或接近0.45°，还取决于细分驱动器的细分电流控制精度等其他因素。不同厂家的细分驱动器的精度可能差别很大，细分数越大，精度越难控制。</p>
<p>(8）四相混合式步进电机与驱动器的串联接法和并联接法有什么区别?</p>
<p>​        四相混合式步进电机一般由两相驱动器来驱动，因此连接时可以采用串联接法或并联接法将四相电机接成两相使用。串联接法一般在电机转速较低的场合使用，此时需要的驱动器输出电流为电机相电流的0.7倍，因而电机发热小;并联接法一般在电机转速较高的场合使用(又称高速接法)，所需要的驱动器输出电流为电机相电流的1.4倍，因而电机发热较大。</p>
<p>(9）如何确定步进电机驱动器的直流供电电源?</p>
<p>①电压的确定。混合式步进电机驱动器的供电电源电压一般有一个较宽的范围(12<del>48VDC)，电源电压通常根据电机的工作转速和响应要求来选择。如果电机工作转速较高或响应要求较快，那么电压取值也高，但注意电源电压的纹波不能超过驱动器的最大输入电压，否则可能损坏驱动器。<br>②电流的确定。供电电源电流一般根据驱动器的输出相电流Ⅰ来确定。如果采用线性电源，电源电流一般可取I值的1.1</del>1.3倍;如果采用开关电源，电源电流一般可取I值的1.5~2.0倍。</p>
<p>(10）混合式步进电机驱动器的脱机信号FREE一般在什么情况下使用?</p>
<p>​         当脱机信号 FREE为低电平时，驱动器输出到电机的电流被切断，电机转子处于自由状态(脱机状态)。在有些自动化设备中，如果在驱动器不断电的情况下要求直接转动电机轴(手动方式)，就可以将FREE信号置低，使电机脱机，进行手动操作或调节。手动完成后，再将FREE信号置高，以继续自动控制。</p>
<p>(11）如何用简单的方法调整两相步进电机通电后的转动方向?</p>
<p>​        只需将电机与驱动器接线的A+和A-（或B+和B-)对调即可。</p>
<p>(12）关于驱动器的细分原理及一些相关说明。</p>
<p>​        在国外，对于步进系统，主要采用二相混合式步进电机及相应的细分驱动器。但在国内，广大用户对“细分”还不是特别了解，有些人认为，细分是为了提高精度，其实不然，细分主要是改善电机的运行性能,现说明如下：<br>​        步进电机的细分控制是由驱动器精确控制步进电机的相电流来实现的，以二相电机为例，假如电机的额定相电流为3A，如果使用常规驱动器（如常用的恒流斩波方式）驱动该电机，电机每运行一步，其绕组内的电流将从0突变为3A或从3A突变到0，相电流的巨大变化，必然会引起电机运行的振动和噪声。如果使用细分驱动器，在10细分状态下驱动该电机，电机每运行一微步，其绕组内的电流变化只有0.3A而不是3A，且电流是以正弦曲线规律变化，这样就大大改善了电机的振动和噪声，因此性能上的优点才是细分的真正优点。由于细分驱动器要精确控制电机的相电流，所以对驱动器有相当高的技术和工艺要求，成本亦会较高。注意，国内有一些驱动器采用“平滑”来取代细分，有的亦称为细分，但这不是真正的细分，望广大用户一定要分清两者的本质不同:<br>“平滑”并不精确控制电机的相电流，只是把电流的变化率变缓一些，所以“平滑”并不产生微步，而细分的微步是可以用来精确定位的。<br>电机的相电流被平滑后，会引起电机力矩的下降，而细分控制不但不会引起电机力矩的下降，相反，力矩会有所增加。</p>
<h2 id="10舵机"><a href="#10舵机" class="headerlink" title="10舵机"></a>10舵机</h2><h3 id="10-1舵机概述"><a href="#10-1舵机概述" class="headerlink" title="10.1舵机概述"></a>10.1舵机概述</h3><p>​        舵机英文称Servo，也称伺服机。其特点是结构紧凑、易安装调试、控制简单、大扭力、成本较低等。舵机的主要性能取决于最大力矩和工作速度（一般是以秒&#x2F;60°为单位）。它是一种位置伺服的驱动器，适用于那些需要角度不断变化并能够保持的控制系统。在机器人机电控制系统中，舵机控制效果是性能的重要影响因素。舵机能够在微机电系统和航模中作为基本的输出执行机构，其简单的控制和输出使得单片机系统很容易与之接口。</p>
<h3 id="10-2舵机工作原理"><a href="#10-2舵机工作原理" class="headerlink" title="10.2舵机工作原理"></a>10.2舵机工作原理</h3><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%88%B5%E6%9C%BA%E5%BC%95%E7%BA%BF%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="舵机引线示意图"></p>
<p>​        在航模遥控系统中，控制信号由接收机的通道进入信号调制芯片，获得直流偏置电压。它的内部有一个基准电路，产生周期为20ms、宽度为1.5ms 的基准信号，并将获得的直流偏置电压和电位器的电压比较，获得电压差输出。最后，将电压差的正、负输出到电机驱动芯片决定电机的正、反转。当电机转速一定时，通过级联减速齿轮带动电位器旋转，使电压差为0，电机停止转动。舵机的控制信号也是PWM信号，利用占空比的变化改变舵机的位置。下图为舵机输出转角与输入信号脉冲宽度的关系, 其脉冲宽度在0.5～2.5ms变化时, 舵机输出轴转角在0°～180°变化。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%88%B5%E6%9C%BA%E8%BE%93%E5%87%BA%E8%BD%AC%E8%A7%92%E4%B8%8E%E8%BE%93%E5%85%A5%E4%BF%A1%E5%8F%B7%E8%84%89%E5%86%B2%E5%AE%BD%E5%BA%A6%E7%9A%84%E5%85%B3%E7%B3%BB.png" alt="舵机输出转角与输入信号脉冲宽度的关系"></p>
<h1 id="二-单片机概述"><a href="#二-单片机概述" class="headerlink" title="二.单片机概述"></a>二.单片机概述</h1><p>单片机，英文Micro Controller Unit，简称MCU，内部集成了CPU、RAM、ROM、定时器、中断系统、通讯接口等一系列电脑的常用硬件功能。单片机的任务是信息采集（依靠传感器）、处理（依靠CPU）和硬件设备（例如电机，LED等）的控制。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99.png" alt="命名规则"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8D%95%E7%89%87%E6%9C%BA%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="单片机内部结构图"></p>
<p>单片机最小系统，或者称为最小应用系统，是指用最少的元件组成的单片机可以工作的系统。 对51系列单片机来说，最小系统一般应该包括：单片机、晶振电路、复位电路。</p>
<p>单片机输出与输入为TTL电平,其中高电平为+5V，低电平为0V。计算机的串口为RS-232C电平，其中高电平为-12V，低电平为+12V。单片机上电，默认都是高电平。</p>
<h1 id="三-C51代码编写基础知识"><a href="#三-C51代码编写基础知识" class="headerlink" title="三.C51代码编写基础知识"></a>三.C51代码编写基础知识</h1><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2.png" alt="进制转换"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png" alt="数据类型"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%95%B0%E6%8D%AE%E8%BF%90%E7%AE%97.png" alt="数据运算"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9F%BA%E6%9C%AC%E8%AF%AD%E5%8F%A5.png" alt="基本语句"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B.png" alt="模块化编程"></p>
<p>.c文件：函数、变量的定义</p>
<p>.h文件：可被外部调用的函数、变量的声明</p>
<p>任何自定义的变量、函数在调用前必须有定义或声明（同一个.c）</p>
<p>使用到的自定义函数的.c文件必须添加到工程参与编译</p>
<p>使用到的.h文件必须要放在编译器可寻找到的地方（工程文件夹根目录、安装目录、自定义）</p>
<p>sfr（special function register）：特殊功能寄存器声明</p>
<p> 例：sfr P0 &#x3D; 0x80;</p>
<p> 声明P0口寄存器，物理地址为0x80</p>
<p>sbit（special bit）：特殊位声明</p>
<p> 例：sbit P0_1 &#x3D; 0x81;  或  sbit P0_1 &#x3D; P0^1;</p>
<p> 声明P0寄存器的第1位</p>
<p>可位寻址&#x2F;不可位寻址：在单片机系统中，操作任意寄存器或者某一位的数据时，必须给出其物理地址，又因为一个寄存器里有8位，所以位的数量是寄存器数量的8倍，单片机无法对所有位进行编码，故每8个寄存器中，只有一个是可以位寻址的。对不可位寻址的寄存器，若要只操作其中一位而不影响其它位时，可用“&amp;&#x3D;”、“|&#x3D;”、“^&#x3D;”的方法进行位操作</p>
<h1 id="三-独立按键"><a href="#三-独立按键" class="headerlink" title="三.独立按键"></a>三.独立按键</h1><p>​        对于机械开关，当机械触点断开、闭合时，由于机械触点的弹性作用，一个开关在闭合时不会马上稳定地接通，在断开时也不会一下子断开，所以在开关闭合及断开的瞬间会伴随一连串的抖动。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8C%89%E9%94%AE%E6%8A%96%E5%8A%A8.png" alt="按键抖动"></p>
<p>利用延时进行去抖。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(P3_1==<span class="number">0</span>)			<span class="comment">//检测k1是否按下</span></span><br><span class="line">		&#123;</span><br><span class="line">			Delay(<span class="number">20</span>);		<span class="comment">//延时去抖</span></span><br><span class="line">			<span class="keyword">while</span>(P3_1==<span class="number">0</span>);	<span class="comment">//等待按键释放</span></span><br><span class="line">			Delay(<span class="number">20</span>);		<span class="comment">//延时去抖</span></span><br><span class="line">			</span><br><span class="line">			P2_0=~P2_0;		<span class="comment">//LED1亮灭</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Key</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> KeyNumber=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(P3_1==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_1==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">1</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P3_0==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_0==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">2</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P3_2==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_2==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">3</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(P3_3==<span class="number">0</span>)&#123;Delay(<span class="number">20</span>);<span class="keyword">while</span>(P3_3==<span class="number">0</span>);Delay(<span class="number">20</span>);KeyNumber=<span class="number">4</span>;&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> KeyNumber;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="四-数码管"><a href="#四-数码管" class="headerlink" title="四.数码管"></a>四.数码管</h1><h2 id="4-1数码管基础知识"><a href="#4-1数码管基础知识" class="headerlink" title="4.1数码管基础知识"></a>4.1数码管基础知识</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%95%B0%E7%A0%81%E7%AE%A1%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86%E5%9B%BE.png" alt="数码管内部原理图"></p>
<p>​                                                                                  有共阴极和共阳极两种方式。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9B%9B%E4%BD%8D%E4%B8%80%E4%BD%93.png" alt="四位一体"></p>
<h2 id="4-2数码管静态显示"><a href="#4-2数码管静态显示" class="headerlink" title="4.2数码管静态显示"></a>4.2数码管静态显示</h2><p>​       当多位数码管应用于某一系统时，它们的“位选”是可独立控制的，而“段选”是连接在一起的，我们可以通过位选信号控制哪几个数码管亮，而在同一时刻，位选选通的所有数码管上显示的数字始终都是一样的，因为它们的段选是连接在一起的，所以送入所有数码管的段选信号都是相同的，那么它们显示的数字必定一样，数码管的这种显示方法叫做静态显示。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%95%B0%E7%A0%81%E7%AE%A1%E4%B8%8E%E5%8D%95%E7%89%87%E6%9C%BA%E8%BF%9E%E6%8E%A5%E5%9B%BE.png" alt="数码管与单片机连接图"></p>
<p>​       TX-1C实验板上使用的数码管为共阴极，图中，最上面一排是6个单位数码管，可以看到所有数码管的阳极，即标有a，b，c，d，e， f，g， h的引脚全部连接在一起，然后与下面的U1元件73HC573锁存器的数据输出端相连，锁存器的数据输入端连接单片机的PO口，PO口同时加了上拉电阻。数码管中WE1，WE2，WE3，WE4，WE5，WE6是它们的位选端，每一个数码对应一个位选端，与下面U2元件74HC573的数据输出端的低6位相连，U2的数据输入端也连接到单片机的PO口。两个锁存器的锁存端分别与单片机的P2.6和P2.7相连，用单片机可以控制锁存器的锁存端，进而控制锁存器的数据输出，这种分时控制的方法便可方便地控制任意数码管显示任意数字。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">**********************************************************************</span><br><span class="line"></span><br><span class="line">程序功能：	让TX<span class="number">-1</span>C学习板的第一个数码管静态的显示数字<span class="number">3</span>。</span><br><span class="line"></span><br><span class="line">**********************************************************************/</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg51.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit dula=P2^<span class="number">6</span>;		<span class="comment">//段选信号的锁存器控制</span></span><br><span class="line">sbit wela=P2^<span class="number">7</span>;		<span class="comment">//位选信号的锁存器控制</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	dula=<span class="number">0</span>;</span><br><span class="line">	wela=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	P0=<span class="number">0x4f</span>;	   <span class="comment">//数字“3”的代码</span></span><br><span class="line">	dula=<span class="number">1</span>;</span><br><span class="line">	dula=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	P0=<span class="number">0xfe</span>;	   <span class="comment">//选中第一个数码管</span></span><br><span class="line">	wela=<span class="number">1</span>;</span><br><span class="line">	wela=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-3数码管动态显示"><a href="#4-3数码管动态显示" class="headerlink" title="4.3数码管动态显示"></a>4.3数码管动态显示</h2><p>​        所谓动态扫描显示，即轮流向各位数码管送出字形码和相应的位选，利用发光管的余辉和人眼视觉暂留作用，使人的感觉好像各位数码管同时都在显示，而实际上多位数码管是一位一位轮流显示的，只是轮流的速度非常快，人眼已经无法分辨出来。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">**********************************************************************</span><br><span class="line"></span><br><span class="line">程序功能：	让TX<span class="number">-1</span>C学习板的六位数码管同时显示数字<span class="number">0</span>到<span class="number">5</span>。</span><br><span class="line"></span><br><span class="line">**********************************************************************/</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg51.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit dula=P2^<span class="number">6</span>;		<span class="comment">//段选信号的锁存器控制</span></span><br><span class="line">sbit wela=P2^<span class="number">7</span>;		<span class="comment">//位选信号的锁存器控制</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code wei[]=&#123;<span class="number">0xfe</span>,<span class="number">0xfd</span>,<span class="number">0xfb</span>,<span class="number">0xf7</span>,<span class="number">0xef</span>,<span class="number">0xdf</span>&#125;;</span><br><span class="line">						<span class="comment">//数码管各位的码表</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code duan[]=&#123;<span class="number">0x3f</span>,<span class="number">0x06</span>,<span class="number">0x5b</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,<span class="number">0x6d</span>&#125;;</span><br><span class="line">						<span class="comment">//0-5的码表</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> i)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> m,n;</span><br><span class="line">	<span class="keyword">for</span>(m=i;m&gt;<span class="number">0</span>;m--)</span><br><span class="line">		<span class="keyword">for</span>(n=<span class="number">90</span>;n&gt;<span class="number">0</span>;n--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> num;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(num=<span class="number">0</span>;num&lt;<span class="number">6</span>;num++)</span><br><span class="line">		&#123;</span><br><span class="line">			P0=wei[num];	   </span><br><span class="line">			wela=<span class="number">1</span>;</span><br><span class="line">			wela=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			P0=duan[num];	  </span><br><span class="line">			dula=<span class="number">1</span>;</span><br><span class="line">			dula=<span class="number">0</span>;</span><br><span class="line">			delay(<span class="number">2</span>);	 <span class="comment">//时间间隔短，这是关键（所谓的同时显示，只是间隔较短而已，利用人眼的余辉效应，觉得每个数码管都一直在亮）。</span></span><br><span class="line">		 &#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="五-矩阵键盘"><a href="#五-矩阵键盘" class="headerlink" title="五.矩阵键盘"></a>五.矩阵键盘</h1><p>​        独立键盘与单片机连接时，每一个按键都需要单片机的一个I&#x2F;O口，为了节省IO口线，我们引入矩阵键盘。<br>​        将16个按键排成4行4列，第一行将每个按键的一端连接在一起构成行线，第一列将每个按键的另一端连接在一起构成列线，这样便一共有4行4列共8根线，我们将这8根线连接到单片机的8个IO口上，通过程序扫描键盘就可检测16个键.用这种方法我们也可实现3行3列9个键、5行5列25个键、6行6列36个键等。<br>​        无论是独立键盘还是矩阵键盘，单片机检测其是否被按下的依据都是一样的，也就是检测与该键对应的IO口是否为低电平。独立键盘有一端固定为低电平，单片机写程序检测时比较方便。而矩阵键盘两端都与单片机IO口相连，因此在检测时需人为通过单片机I&#x2F;O口送出低电平。检测时，先送一列为低电平，其余几列全为高电平(此时我们确定了列数)，然后立即轮流检测一次各行是否有低电平，若检测到某一行为低电平（这时我们又确定了行数)，则我们便可确认当前被按下的键是哪一行哪一列的，用同样方法轮流送各列一次低电平，再轮流检测一次各行是否变为低电平，这样即可检测完所有的按键，当有键被按下时便可判断出按下的键是哪一个键。当然我们也可以将行线置低电平，扫描列是否有低电平。这就是矩阵键盘检测的原理和方法。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%9F%A9%E9%98%B5%E9%94%AE%E7%9B%98%E8%BF%9E%E6%8E%A5%E5%9B%BE.png" alt="矩阵键盘连接图"></p>
<h1 id="六-定时器"><a href="#六-定时器" class="headerlink" title="六.定时器"></a>六.定时器</h1><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A8.png" alt="定时器"></p>
<p>STC89C52的T0和T1均有四种工作模式：</p>
<p>模式0：13位定时器&#x2F;计数器</p>
<p>模式1：16位定时器&#x2F;计数器（常用）</p>
<p>模式2：8位自动重装模式</p>
<p>模式3：两个8位计数器</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A80%E7%9A%84%E6%A8%A1%E5%BC%8F1.png" alt="定时器0的模式1"></p>
<p>左边时钟，中间计数，右边中断        65535</p>
<h1 id="七-中断"><a href="#七-中断" class="headerlink" title="七.中断"></a>七.中断</h1><p>​        引起CPU中断的根源，称为中断源，中断源向CPU提出中断请求，CPU暂时中断原来的事务A，转去处理事件B，对事件B处理完毕后，再回到原来被中断的地方（即断点)，称为中断返回。实现上述中断功能的部件称为中断系统（中断机构)。</p>
<p>52单片机一共有6个中断源，它们的符号、名称及产生的条件分别解释如下:</p>
<p>INTO—外部中断0，由P3.2端口线引入，低电平或下降沿引起。</p>
<p>INT1—外部中断1，由 P3.3端口线引入，低电平或下降沿引起。T0—定时器&#x2F;计数器О中断，由T0计数器计满回零引起。</p>
<p>T1—定时器&#x2F;计数器1中断，由T1计数器计满回零引起。</p>
<p>T2—定时器&#x2F;计数器⒉中断，由T2计数器计满回零引起。</p>
<p>TI &#x2F; RI—串行口中断，串行端口完成一帧字符发送&#x2F;接收后引起。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%AD%E6%96%AD%E5%8F%B7.png" alt="中断号"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A8%E5%92%8C%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F.png" alt="定时器和中断系统"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9B%B8%E5%85%B3%E5%AF%84%E5%AD%98%E5%99%A8.png" alt="定时器相关寄存器"></p>
<p>​        单片机在使用中断功能时，通常需要设置两个与中断有关的寄存器:中断允许寄存器IE和中断优先级寄存器IP。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%AD%E6%96%AD%E5%85%81%E8%AE%B8%E5%AF%84%E5%AD%98%E5%99%A8IE.png" alt="中断允许寄存器IE"></p>
<p>EA一全局中断允许位。</p>
<p>EA&#x3D;1，打开全局中断控制，在此条件下，由各个中断控制位确定相应中断的打开或关闭。</p>
<p>EA&#x3D;0，关闭全部中断。</p>
<p>–—无效位。</p>
<p>ET2一定时器&#x2F;计数器②中断允许位。ET2&#x3D; 1，打开T2中断。</p>
<p>ET2&#x3D;0，关闭T2中断。</p>
<p>ES一串行口中断允许位。</p>
<p>ES &#x3D; 1，打开串行口中断。</p>
<p>ES &#x3D;0，关闭串行口中断。</p>
<p>ET1一定时器&#x2F;计数器1中断允许位。</p>
<p>ET1 &#x3D; 1，打开T1中断。</p>
<p>ET1 &#x3D;0，关闭T1中断。</p>
<p>EX1一外部中断1中断允许位。</p>
<p>EX1&#x3D;1，打开外部中断1中断。</p>
<p>EX1&#x3D;0，关闭外部中断1中断。</p>
<p>ET0一定时器&#x2F;计数器О中断允许位。</p>
<p>ET0&#x3D;1，打开T0中断。</p>
<p>ET0&#x3D;0，关闭T0中断。</p>
<p>EX0一外部中断0中断允许位。EX0&#x3D;1，打开外部中断О中断。EX0&#x3D;0，关闭外部中断0中断。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%AD%E6%96%AD%E4%BC%98%E5%85%88%E7%BA%A7%E5%AF%84%E5%AD%98%E5%99%A8IP.png" alt="中断优先级寄存器IP"></p>
<p>–—无效位。</p>
<p>PS一串行口中断优先级控制位。</p>
<p>PS &#x3D; 1，串行口中断定义为高优先级中断。</p>
<p>PS &#x3D;0，串行口中断定义为低优先级中断。</p>
<p>PT1一定时器&#x2F;计数器1中断优先级控制位。</p>
<p>PT1&#x3D;1，定时器&#x2F;计数器1中断定义为高优先级中断。</p>
<p>PT1 &#x3D;0，定时器&#x2F;计数器1中断定义为低优先级中断。</p>
<p>PX1一外部中断1中断优先级控制位。<br>PX1&#x3D; 1，外部中断1定义为高优先级中断。</p>
<p>PX1&#x3D;0，外部中断1定义为低优先级中断。</p>
<p>PT0一定时器&#x2F;计数器0中断优先级控制位。<br>PT0&#x3D; 1，定时器&#x2F;计数器0中断定义为高优先级中断。</p>
<p>PT0&#x3D;0，定时器&#x2F;计数器0中断定义为低优先级中断。</p>
<p>PX0一外部中断0中断优先级控制位。</p>
<p>PX0&#x3D;1，外部中断0定义为高优先级中断。</p>
<p>PX0&#x3D;0，外部中断0定义为低优先级中断。</p>
<h2 id="7-2定时器中断"><a href="#7-2定时器中断" class="headerlink" title="7.2定时器中断"></a>7.2定时器中断</h2><p>​       单片机在使用定时器或计数器功能时，通常需要设置两个与定时器有关的寄存器:定时器&#x2F;计数器工作方式寄存器TMOD与定时器&#x2F;计数器控制寄存器TCON。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A8%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F%E5%AF%84%E5%AD%98%E5%99%A8TMOD.png" alt="定时器工作方式寄存器TMOD"></p>
<p>TMOD的高4位用于设置定时器1，低4位用于设置定时器0，对应4位的含义如下:</p>
<p>GATE一门控制位。</p>
<p>GATE&#x3D;0，定时器&#x2F;计数器启动与停止仅受TCON寄存器中 TRX ( X&#x3D;0，1)来控制。</p>
<p>GATE&#x3D;1，定时器&#x2F;计数器启动与停止由TCON寄存器中TRX(X&#x3D;0，1 )和外部中断引脚( INTO或 INT1)上的电平状态来共同控制。</p>
<p>c&#x2F;T一定时器模式和计数器模式选择位。</p>
<p>c&#x2F;T&#x3D;1，为计数器模式;C&#x2F;T&#x3D;o，为定时器模式。</p>
<p>M1MO一工作方式选择位。</p>
<p>每个定时器&#x2F;计数器都有4种工作方式，它们由M1MO设定，对应关系如下表所示。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9A%844%E7%A7%8D%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F.png" alt="定时器的4种工作方式"></p>
<p>定时器控制寄存器</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A8%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8TCON.png" alt="定时器控制寄存器TCON"></p>
<p>TF1一定时器1溢出标志位。<br>      当定时器1计满溢出时，由硬件使TF1 置1，并且申请中断。进入中断服务程序后，由硬件自动清0。需要注意的是，如果使用定时器的中断，那么该位完全不用人为去操作，但是如果使用软件查询方式的话，当查询到该位置1后，就需要用软件清0.<br>TR1一定时器1运行控制位。<br>       由软件清0关闭定时器1。当GATE&#x3D;1，且INT1为高电平时，TR1置1启动定时器1;当GATE&#x3D;O时，TR1 置1启动定时器1。<br>TF0一定时器0溢出标志，其功能及操作方法同TF1。</p>
<p>TR0一定时器0运行控制位，其功能及操作方法同TR1。</p>
<p>IE1一外部中断1请求标志。<br>      当IT1&#x3D;0时，为电平触发方式，每个机器周期的S5P2采样INT1引脚，若INT1脚为低电平，则置1，否则IE1清0。<br>      当IT1&#x3D;1时，INT1为跳变沿触发方式，当第一个机器周期采样到INT1为低电平时，则IE1置1。IE1&#x3D;1，表示外部中断1正在向CPU申请中断。当CPU响应中断，转向中断服务程序时,该位由硬件清0。<br>IT1一外部中断1触发方式选择位。<br>IT1&#x3D;0，为电平触发方式，引脚 INT1上低电平有效。<br>IT1&#x3D;1，为跳变沿触发方式，引脚INT1上的电平从高到低的负跳变有效。</p>
<p>IE0—外部中断0请求标志，其功能及操作方法同IE1。<br>IT0一外部中断0触发方式选择位，其功能及操作方法同IT1。</p>
<h3 id="7-2-2定时器0的工作方式1-16位定时器"><a href="#7-2-2定时器0的工作方式1-16位定时器" class="headerlink" title="7.2.2定时器0的工作方式1:  16位定时器"></a>7.2.2定时器0的工作方式1:  16位定时器</h3><p>​        方式1的计数位数是16位，对T0来说，由TL0寄存器作为低8位、TH0寄存器作为高8位，组成了16位加1计数器，其逻辑结构框图如下图所示。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AE%9A%E6%97%B6%E5%99%A80%E6%96%B9%E5%BC%8F1%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="定时器0方式1逻辑结构图"></p>
<p>​        当GATE&#x3D;0，TR0&#x3D;1时，TL0便在机器周期的作用下开始加1计数，当TL0计满后向TH0进一位，直到把TH0也计满，此时计数器溢出，置TF0为1，接着向CPU申请中断，接下来CPU进行中断处理。在这种情况下，只要TR0为1，那么计数就不会停止。这就是定时器0的工作方式1的工作过程。</p>
<p>​        接下来讲解如何计算定时器的初值问题。定时器一旦启动，它便在原来的数值上开始加1计数，若在程序开始时，我们没有设置TH0和 TL0，它们的默认值都是0，假设时钟频率为12MHz，12个时钟周期为一个机器周期，那么此时机器周期就是1us，计满TH0和 TL0就需要2l6-1个数，再来一个脉冲计数器溢出，随即向CPU申请中断。因此溢出一次共需65536us，约等于65.5ms，如果我们要定时50ms 的话，那么就需要先给TH0和TL0装一个初值，在这个初值的基础上计50000个数后，定时器溢出，此时刚好就是50ms中断一次，当需定时1s时，我们写程序时当产生20次50ms 的定时器中断后便认为是1s，这样便可精确控制定时时间了。要计50000个数时，TH0和TL0中应该装入的总数是65536-50000&#x3D;15536,把15536对256求模: 15536&#x2F;256&#x3D;60装入TH0中，把15536对256求余:15536%256&#x3D;176装入TL0中。<br>以上就是定时器初值的计算方法，总结后得出如下结论:当用定时器的方式1时，设机器周期为Ty,定时器产生一次中断的时间为t,那么需要计数的个数N&#x3D;t &#x2F; Tcy,装入THX和TLX中的数分别为<br>THX&#x3D;(65536-N)&#x2F;256，TLX&#x3D;(65536-N)%256<br>要计算机器周期Tcy，就需要知道系统时钟频率，也就是单片机的晶振频率，TX-1C实验板上时钟频率为11.0592MHz，那么机器周期为12×(1&#x2F;11059200)～1.09us，若 t&#x3D;50ms，那么N &#x3D;50 000&#x2F;1.09&#x3D;45872，这是晶振在11.0592MHz下定时50ms时初值的计算方法，当晶振为12MHz时，计算起来就比较方便了，用同样方法可算得N&#x3D;50000。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Timer0Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	TMOD &amp;= <span class="number">0xF0</span>;		<span class="comment">//把TMOD的低四位清零，高四位保持不变</span></span><br><span class="line">	TMOD |= <span class="number">0x01</span>;		<span class="comment">//把TMOD的最低位置1，高四位保持不变</span></span><br><span class="line">	TL0 = (<span class="number">65535</span><span class="number">-45872</span>)/<span class="number">256</span>;		<span class="comment">//装初值11.0592M晶振定时50ms数为45872</span></span><br><span class="line">	TH0 = (<span class="number">65535</span><span class="number">-45872</span>)%<span class="number">256</span>;		<span class="comment">//</span></span><br><span class="line">	TF0 = <span class="number">0</span>;		<span class="comment">//清除TF0标志</span></span><br><span class="line">	TR0 = <span class="number">1</span>;		<span class="comment">//定时器0开始计时</span></span><br><span class="line">	ET0=<span class="number">1</span>;          <span class="comment">//开定时器0中断</span></span><br><span class="line">	EA=<span class="number">1</span>;           <span class="comment">//开总中断</span></span><br><span class="line">	PT0=<span class="number">0</span>;          <span class="comment">//中断优先级</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0_Routine</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> T0Count;</span><br><span class="line">	TL0 = (<span class="number">65535</span><span class="number">-45872</span>)/<span class="number">256</span>;		<span class="comment">//装初值11.0592M晶振定时50ms数为45872</span></span><br><span class="line">	TH0 = (<span class="number">65535</span><span class="number">-45872</span>)%<span class="number">256</span>;		</span><br><span class="line">	T0Count++;                      <span class="comment">//T0Count每加1次判断一次是否到20次</span></span><br><span class="line">	<span class="keyword">if</span>(T0Count&gt;=<span class="number">20</span>)                 <span class="comment">//如果到了20次，说明1秒时间到</span></span><br><span class="line">	&#123;</span><br><span class="line">		T0Count=<span class="number">0</span>;                  <span class="comment">//然后把T0Count清0重新再计20次</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="八-串口"><a href="#八-串口" class="headerlink" title="八.串口"></a>八.串口</h1><h2 id="8-1串口概述"><a href="#8-1串口概述" class="headerlink" title="8.1串口概述"></a>8.1串口概述</h2><p>​        串口是一种应用十分广泛的通讯接口，串口成本低、容易使用、通信线路简单，可实现两个设备的互相通信。</p>
<p>​        单片机的串口可以使单片机与单片机、单片机与电脑、单片机与各式各样的模块互相通信，极大的扩展了单片机的应用范围，增强了单片机系统的硬件实力。</p>
<p>​        51单片机内部自带UART（Universal Asynchronous Receiver Transmitter，通用异步收发器），可实现单片机的串口通信。</p>
<p>简单双向串口通信有两根通信线（发送端TXD和接收端RXD）</p>
<p>TXD与RXD要交叉连接</p>
<p>当只需单向的数据传输时，可以直接一根通信线</p>
<p>当电平标准不一致时，需要加电平转换芯片</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%B2%E5%8F%A3%E7%A1%AC%E4%BB%B6%E7%94%B5%E8%B7%AF.png" alt="串口硬件电路"></p>
<h2 id="8-2电平标准"><a href="#8-2电平标准" class="headerlink" title="8.2电平标准"></a>8.2电平标准</h2><p>​        电平标准是数据1和数据0的表达方式，是传输线缆中人为规定的电压与数据的对应关系，串口常用的电平标准有如下三种：</p>
<p>TTL电平：+5V表示1，0V表示0</p>
<p>RS232电平：-3<del>-15V表示1，+3</del>+15V表示0</p>
<p>RS485电平：两线压差+2<del>+6V表示1，-2</del>-6V表示0（差分信号）</p>
<h2 id="8-3常见通信接口比较"><a href="#8-3常见通信接口比较" class="headerlink" title="8.3常见通信接口比较"></a>8.3常见通信接口比较</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%B8%B8%E8%A7%81%E9%80%9A%E4%BF%A1%E6%8E%A5%E5%8F%A3%E6%AF%94%E8%BE%83.png" alt="常见通信接口比较"></p>
<p>此外还有：CAN、USB等。</p>
<p>全双工：通信双方可以在同一时刻互相传输数据</p>
<p>半双工：通信双方可以互相传输数据，但必须分时复用一根数据线</p>
<p>单工：通信只能有一方发送到另一方，不能反向传输</p>
<p>异步：通信双方各自约定通信速率</p>
<p>同步：通信双方靠一根时钟线来约定通信速率</p>
<p>总线：连接各个设备的数据传输线路（类似于一条马路，把路边各住户连接起来，使住户可以相互交流）。</p>
<h2 id="8-4-51单片机的UART"><a href="#8-4-51单片机的UART" class="headerlink" title="8.4 51单片机的UART"></a>8.4 51单片机的UART</h2><p>STC89C52有1个UART</p>
<p>STC89C52的UART有四种工作模式：</p>
<p> 模式0：同步移位寄存器</p>
<p> 模式1：8位UART，波特率可变（常用）</p>
<p> 模式2：9位UART，波特率固定</p>
<p> 模式3：9位UART，波特率可变</p>
<h2 id="8-4串口参数及时序图"><a href="#8-4串口参数及时序图" class="headerlink" title="8.4串口参数及时序图"></a>8.4串口参数及时序图</h2><p>波特率：串口通信的速率（发送和接收各数据位的间隔时间）</p>
<p>检验位：用于数据验证</p>
<p>停止位：用于数据帧间隔</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%B2%E5%8F%A3%E5%8F%82%E6%95%B0%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F.png" alt="串口参数数据格式"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%B2%E8%A1%8C%E5%8F%A3%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84.png" alt="串行口基本结构"></p>
<p>SBUF：串口数据缓存寄存器，物理上是两个独立的寄存器，但占用相同的地址。写操作时，写入的是发送寄存器，读操作时，读出的是接收寄存器</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%B2%E5%8F%A3%E5%92%8C%E4%B8%B2%E5%8F%A3%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F.png" alt="串口和串口中断系统"></p>
<h2 id="8-5波特率"><a href="#8-5波特率" class="headerlink" title="8.5波特率"></a>8.5波特率</h2><p>​       单片机或计算机在串口通信时的速率用波特率表示，它定义为每秒传输二进制代码的位数，即1波特&#x3D;1位&#x2F;秒，单位是 bps (位&#x2F;秒)。如每秒钟传送240个字符，而每个字符格式包含10位(1个起始位、1个停止位、8个数据位),这时的波特率为10位×240个&#x2F;秒&#x3D;2400 bps。</p>
<p>​       在串行通信中，收、发双方对发送或接收数据的速率要有约定。通过编程可对单片机串行口设定为4种工作方式，其中方式0和方式2的波特率是固定的，而方式1和方式3的波特率是可变的，由定时器T1的溢出率来决定。<br>​       串行口的4种工作方式对应三种波特率。由于输入的移位时钟的来源不同，所以各种方式的波特率计算公式也不相同，以下是4种方式波特率的计算公式。<br>方式0的波特率 &#x3D;fosc&#x2F;12。</p>
<p>方式1的波特率 &#x3D; (2^SMOD &#x2F;32) x(T1溢出率)。</p>
<p>方式2的波特率 &#x3D; (2^SMOD&#x2F;64）×fosc 。</p>
<p>方式3的波特率&#x3D;(2^SMOD &#x2F;32）×(T1溢出率)。</p>
<p>​        式中，fosc为系统晶振频率，通常为12MHz或11.0592MHz;SMOD是PCON寄存器的最高位；T1溢出率即定时器T1溢出的频率。T1溢出率就是T1定时器溢出的频率，只要算出T1定时器每溢出一次所需的时间T，那么T的倒数1&#x2F;T就是它的溢出率。</p>
<p>【例】已知串口通信在串口方式1下，波特率为9600bps，系统晶振频率为11.0592MHz，求TL1和TH1中装入的数值是多少?<br>解:</p>
<p>​       设所求的数为X，则定时器每计256-X个数溢出一次，每计一个数的时间为一个机器周期，一个机器周期等于12个时钟周期，所以计一个数的时间为12&#x2F;11.0592MHz (s)，那么定时器溢出一次的时间为[256-X]x12&#x2F;11.0592MHz (s)，T1的溢出率就是它的倒数，方式1的波特率&#x3D; (2^SMOD &#x2F;32)x(T1溢出率)，这里我们取SMOD&#x3D;0，则2^SMOD&#x3D;1，将已知的数代入公式后得9600&#x3D;(1&#x2F;32)x11059200&#x2F;[256-X]×12，求得X&#x3D;253，转换成十六进制为0xFD。上面若将SMOD置1的话，那么X的值就变成250了。可见，在不变化X值的状态下，SMOD由0变1后，波特率便增加一倍。</p>
<h2 id="8-6串行口控制寄存器SCON"><a href="#8-6串行口控制寄存器SCON" class="headerlink" title="8.6串行口控制寄存器SCON"></a>8.6串行口控制寄存器SCON</h2><p>​        串行口控制寄存器SCON在特殊功能寄存器中，字节地址为98H，可位寻址，SCON用以设定串行口的工作方式、接收&#x2F;发送控制以及设置状态标志等。单片机复位时SCON全部被清0。其各位的定义如表所示。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%B2%E8%A1%8C%E5%8F%A3%E6%8E%A7%E5%88%B6%E5%AF%84%E5%AD%98%E5%99%A8SCON.png" alt="串行口控制寄存器SCON"></p>
<p>SM0，SM1一工作方式选择位。</p>
<p>​        串行口有4种工作方式，它们由SMO，SM1设定，对应关系如表所示。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%B8%B2%E8%A1%8C%E5%8F%A3%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F.png" alt="串行口工作方式"></p>
<p>SM2—多机通信控制位。<br>         SM2主要用于方式2和方式3。当接收机的SM2&#x3D;1时，可以利用收到的RB8来控制是否激活RI (RB8&#x3D;0时不激活RI，收到的信息丢弃;RB8&#x3D; 1时收到的数据进入SBUF，并激活RI，进而在中断服务中将数据从SBUF读走)。当SM2&#x3D;0时，不论收到的RB8是0还是1，均可以使收到的数据进入SBUF，并激活RI （即此时RB8不具有控制RI激活的功能)。通过控制SM2，可以实现多机通信。在方式0时，SM2必须是0。在方式1时，若SM2&#x3D;1，则只有接收到有效停止位时，RI 才置1。<br>REN一允许串行接收位。<br>REN&#x3D;1:允许串行口接收数据;REN&#x3D;0:禁止串行口接收数据。</p>
<p>TB8—方式2，3中发送数据的第9位。<br>        在方式2或方式3中，是发送数据的第9位，可以用软件规定其作用。可以用做数据的奇偶校验位，或在多机通信中，作为地址帧&#x2F;数据帧的标志位。在方式0和方式1中，该位未用。<br>RB8—方式2，3中接收数据的第9位。<br>        在方式2或方式3中，是接收数据的第9位，可作为奇偶校验位或地址帧&#x2F;数据帧的标志位。在方式1时，若SM2&#x3D;0，则RB8是接收到的停止位。<br>TI一发送中断标志位。<br>        在方式0时，当串行发送第8位数据结束时，或在其他方式，串行发送停止位的开始时，由内部硬件使TI置1，向CPU发出中断申请。在中断服务程序中，必须用软件将其清0，取消此中断申请。<br>RI一接收中断标志位。<br>        在方式0时，当串行接收第8位数据结束时，或在其他方式，串行接收停止位的中间时，由内部硬件使RI置1，向CPU发出中断申请。也必须在中断服务程序中，用软件将其清0,取消此中断申请。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//串口初始化</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	SCON=<span class="number">0x40</span>;          <span class="comment">//8位数据，可变波特率</span></span><br><span class="line">	PCON |= <span class="number">0x80</span>;       <span class="comment">//使能波特率倍速位</span></span><br><span class="line">	TMOD &amp;= <span class="number">0x0F</span>;		<span class="comment">//设置定时器模式  清除定时器1模式位</span></span><br><span class="line">	TMOD |= <span class="number">0x20</span>;		<span class="comment">//设置定时器1为8位自动重装方式</span></span><br><span class="line">	TL1 = <span class="number">0xF3</span>;		<span class="comment">//设置定时初值</span></span><br><span class="line">	TH1 = <span class="number">0xF3</span>;		<span class="comment">//设定定时器重装值</span></span><br><span class="line">	ET1 = <span class="number">0</span>;		<span class="comment">//禁止定时器1中断</span></span><br><span class="line">	TR1 = <span class="number">1</span>;		<span class="comment">//启动定时器1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UART.h&quot;</span></span></span><br><span class="line"><span class="comment">//串口向电脑发送一个数据</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Sec;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	UART_Init();			<span class="comment">//</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		UART_SendByte(Sec);	<span class="comment">//</span></span><br><span class="line">		Sec++;				<span class="comment">//</span></span><br><span class="line">		Delay(<span class="number">1000</span>);		<span class="comment">//</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>电脑通过串口控制LED</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">UART_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	SCON=<span class="number">0x50</span>;</span><br><span class="line">	PCON |= <span class="number">0x80</span>;</span><br><span class="line">	TMOD &amp;= <span class="number">0x0F</span>;		</span><br><span class="line">	TMOD |= <span class="number">0x20</span>;		</span><br><span class="line">	TL1 = <span class="number">0xF3</span>;		</span><br><span class="line">	TH1 = <span class="number">0xF3</span>;		</span><br><span class="line">	ET1 = <span class="number">0</span>;		</span><br><span class="line">	TR1 = <span class="number">1</span>;		</span><br><span class="line">	EA=<span class="number">1</span>;</span><br><span class="line">	ES=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UART.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	UART_Init();		</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UART_Routine</span><span class="params">()</span> interrupt 4</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(RI==<span class="number">1</span>)					</span><br><span class="line">	&#123;</span><br><span class="line">		P2=~SBUF;				</span><br><span class="line">		UART_SendByte(SBUF);	</span><br><span class="line">		RI=<span class="number">0</span>;					</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="九-LED点阵屏"><a href="#九-LED点阵屏" class="headerlink" title="九.LED点阵屏"></a>九.LED点阵屏</h1><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%82%B9%E9%98%B5%E5%B1%8F.png" alt="点阵屏"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%82%B9%E9%98%B5%E5%B1%8F2.png" alt="点阵屏2"></p>
<p>LED点阵屏的结构类似于数码管，只不过是数码管把每一列的像素以“8”字型排列而已。</p>
<p>LED点阵屏与数码管一样，有共阴和共阳两种接法，不同的接法对应的电路结构不同。</p>
<p>LED点阵屏需要进行逐行或逐列扫描，才能使所有LED同时显示。</p>
<h1 id="十-DS1302实时时钟"><a href="#十-DS1302实时时钟" class="headerlink" title="十.DS1302实时时钟"></a>十.DS1302实时时钟</h1><h2 id="10-1DS1302实时时钟概述"><a href="#10-1DS1302实时时钟概述" class="headerlink" title="10.1DS1302实时时钟概述"></a>10.1DS1302实时时钟概述</h2><p>DS1302是由美国DALLAS公司推出的具有涓细电流充电能力的低功耗实时时钟芯片。它可以对年、月、日、周、时、分、秒进行计时，且具有闰年补偿等多种功能。</p>
<p>RTC(Real Time Clock)：实时时钟，是一种集成电路，通常称为时钟芯片。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS1302%E5%BC%95%E8%84%9A%E5%AE%9A%E4%B9%89%E5%8F%8A%E7%94%B5%E8%B7%AF.png" alt="DS1302引脚定义及电路"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS1302%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="DS1302内部结构图"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS1302%E5%AF%84%E5%AD%98%E5%99%A8%E5%AE%9A%E4%B9%89.png" alt="DS1302寄存器定义"></p>
<h2 id="10-2时序定义"><a href="#10-2时序定义" class="headerlink" title="10.2时序定义"></a>10.2时序定义</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS1302%E6%97%B6%E5%BA%8F%E5%AE%9A%E4%B9%89.png" alt="DS1302时序定义"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">DS1302_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	DS1302_CE=<span class="number">0</span>;</span><br><span class="line">	DS1302_SCLK=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">DS1302_WriteByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Command,Data)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	DS1302_CE=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DS1302_IO=Command&amp;(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">		DS1302_SCLK=<span class="number">1</span>;</span><br><span class="line">		DS1302_SCLK=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DS1302_IO=Data&amp;(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">		DS1302_SCLK=<span class="number">1</span>;</span><br><span class="line">		DS1302_SCLK=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	DS1302_CE=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">DS1302_ReadByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Command)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i,Data=<span class="number">0x00</span>;</span><br><span class="line">	Command|=<span class="number">0x01</span>;	</span><br><span class="line">	DS1302_CE=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DS1302_IO=Command&amp;(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">		DS1302_SCLK=<span class="number">0</span>;</span><br><span class="line">		DS1302_SCLK=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DS1302_SCLK=<span class="number">1</span>;</span><br><span class="line">		DS1302_SCLK=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(DS1302_IO)&#123;Data|=(<span class="number">0x01</span>&lt;&lt;i);&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	DS1302_CE=<span class="number">0</span>;</span><br><span class="line">	DS1302_IO=<span class="number">0</span>;	</span><br><span class="line">	<span class="keyword">return</span> Data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="十一-蜂鸣器"><a href="#十一-蜂鸣器" class="headerlink" title="十一.蜂鸣器"></a>十一.蜂鸣器</h1><p>蜂鸣器是一种将电信号转换为声音信号的器件，常用来产生设备的按键音、报警音等提示信号。</p>
<p>蜂鸣器按驱动方式可分为有源蜂鸣器和无源蜂鸣器。</p>
<p>有源蜂鸣器：内部自带振荡源，将正负极接上直流电压即可持续发声，频率固定。</p>
<p>无源蜂鸣器：内部不带振荡源，需要控制器提供振荡脉冲才可发声，调整提供振荡脉冲的频率，可发出不同频率的声音。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%9C%82%E9%B8%A3%E5%99%A8%E9%A9%B1%E5%8A%A8%E7%94%B5%E8%B7%AF.png" alt="蜂鸣器驱动电路"></p>
<h1 id="十二-AT24C02及I-2C总线"><a href="#十二-AT24C02及I-2C总线" class="headerlink" title="十二.AT24C02及I^2C总线"></a>十二.AT24C02及I^2C总线</h1><h2 id="12-1AT24C02概述"><a href="#12-1AT24C02概述" class="headerlink" title="12.1AT24C02概述"></a>12.1AT24C02概述</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%AD%98%E5%82%A8%E5%99%A8%E4%BB%8B%E7%BB%8D.png" alt="存储器介绍"></p>
<p>AT24C02是一种可以实现掉电不丢失的存储器，可用于保存单片机运行时想要永久保存的数据信息</p>
<p>存储介质：E2PROM</p>
<p>通讯接口：I2C总线</p>
<p>容量：256字节</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/AT24C02.png" alt="AT24C02"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/AT24C02%E5%BC%95%E8%84%9A%E5%8F%8A%E5%BA%94%E7%94%A8%E7%94%B5%E8%B7%AF.png" alt="AT24C02引脚及应用电路"></p>
<h2 id="12-2-I2C总线概述"><a href="#12-2-I2C总线概述" class="headerlink" title="12.2 I2C总线概述"></a>12.2 I2C总线概述</h2><p>I2C总线（Inter IC BUS）是由Philips公司开发的一种通用数据总线。</p>
<p>两根通信线：SCL（Serial Clock）、SDA（Serial Data）。</p>
<p>同步、半双工，带数据应答。</p>
<p>​        通用的I2C总线，可以使各种设备的通信标准统一，对于厂家来说，使用成熟的方案可以缩短芯片设计周期、提高稳定性，对于应用者来说，使用通用的通信协议可以避免学习各种各样的自定义协议，降低了学习和应用的难度。</p>
<h2 id="12-3-I2C电路规范"><a href="#12-3-I2C电路规范" class="headerlink" title="12.3 I2C电路规范"></a>12.3 I2C电路规范</h2><p>​        所有I2C设备的SCL连在一起，SDA连在一起。</p>
<p>​        设备的SCL和SDA均要配置成开漏输出模式。</p>
<p>​         SCL和SDA各添加一个上拉电阻，阻值一般为4.7KΩ左右。</p>
<p>​        开漏输出和上拉电阻的共同作用实现了“线与”的功能，此设计主要是为了解决多机通信互相干扰的问题。</p>
<h2 id="12-4-I2C时序结构"><a href="#12-4-I2C时序结构" class="headerlink" title="12.4 I2C时序结构"></a>12.4 I2C时序结构</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/I2C%E6%97%B6%E5%BA%8F%E7%BB%93%E6%9E%84.png" alt="I2C时序结构"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82.png" alt="发送一个字节"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%A5%E6%94%B6%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82.png" alt="接收一个字节"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%BA%94%E7%AD%94.png" alt="应答"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8F%91%E9%80%81%E4%B8%80%E5%B8%A7%E6%95%B0%E6%8D%AE.png" alt="发送一帧数据"></p>
<p>​        主机发送启动信号后，再发出寻址信号。器件地址有7位和10位两种，这里只介绍7位地址寻址方式。寻址信号由一个字节构成，高7位为地址位，最低位为方向位，用以表明主机与从器件的数据传送方向。方向位为0，表明主机接下来对从器件进行写操作;方向位为1，表明主机接下来对从器件进行读操作。</p>
<p>​        主机发送地址时，总线上的每个从机都将这7位地址码与自己的地址进行比较，如果相同，则认为自己正被主机寻址，根据R&#x2F;W位将自己确定为发送器或接收器。<br>​        从机的地址由固定部分和可编程部分组成。在一个系统中可能希望接入多个相同的从机，从机地址中可编程部分决定了可接入总线该类器件的最大数目。如一个从机的7位寻址位有4位是固定位，3位是可编程位，这时仅能寻址8个同样的器件，即可以有8个同样的器件接入到该I2C总线系统中。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%8E%A5%E6%94%B6%E4%B8%80%E5%B8%A7%E6%95%B0%E6%8D%AE.png" alt="接收一帧数据"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%85%88%E5%8F%91%E9%80%81%E5%86%8D%E6%8E%A5%E6%94%B6%E6%95%B0%E6%8D%AE%E5%B8%A7.png" alt="先发送再接收数据帧"></p>
<p>![字节写 随机读](..&#x2F;images&#x2F;51单片机学习笔记&#x2F;字节写 随机读.png)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit I2C_SCL=P2^<span class="number">1</span>;</span><br><span class="line">sbit I2C_SDA=P2^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">I2C_Start</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	I2C_SDA=<span class="number">1</span>;</span><br><span class="line">	I2C_SCL=<span class="number">1</span>;</span><br><span class="line">	I2C_SDA=<span class="number">0</span>;</span><br><span class="line">	I2C_SCL=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">I2C_Stop</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	I2C_SDA=<span class="number">0</span>;</span><br><span class="line">	I2C_SCL=<span class="number">1</span>;</span><br><span class="line">	I2C_SDA=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">I2C_SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		I2C_SDA=Byte&amp;(<span class="number">0x80</span>&gt;&gt;i);</span><br><span class="line">		I2C_SCL=<span class="number">1</span>;</span><br><span class="line">		I2C_SCL=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">I2C_ReceiveByte</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i,Byte=<span class="number">0x00</span>;</span><br><span class="line">	I2C_SDA=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		I2C_SCL=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(I2C_SDA)&#123;Byte|=(<span class="number">0x80</span>&gt;&gt;i);&#125;</span><br><span class="line">		I2C_SCL=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Byte;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">I2C_SendAck</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> AckBit)</span></span><br><span class="line">&#123;</span><br><span class="line">	I2C_SDA=AckBit;</span><br><span class="line">	I2C_SCL=<span class="number">1</span>;</span><br><span class="line">	I2C_SCL=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">I2C_ReceiveAck</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> AckBit;</span><br><span class="line">	I2C_SDA=<span class="number">1</span>;</span><br><span class="line">	I2C_SCL=<span class="number">1</span>;</span><br><span class="line">	AckBit=I2C_SDA;</span><br><span class="line">	I2C_SCL=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> AckBit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;I2C.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> AT24C02_ADDRESS		0xA0</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">AT24C02_WriteByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> WordAddress,Data)</span></span><br><span class="line">&#123;</span><br><span class="line">	I2C_Start();</span><br><span class="line">	I2C_SendByte(AT24C02_ADDRESS);</span><br><span class="line">	I2C_ReceiveAck();</span><br><span class="line">	I2C_SendByte(WordAddress);</span><br><span class="line">	I2C_ReceiveAck();</span><br><span class="line">	I2C_SendByte(Data);</span><br><span class="line">	I2C_ReceiveAck();</span><br><span class="line">	I2C_Stop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">AT24C02_ReadByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> WordAddress)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> Data;</span><br><span class="line">	I2C_Start();</span><br><span class="line">	I2C_SendByte(AT24C02_ADDRESS);</span><br><span class="line">	I2C_ReceiveAck();</span><br><span class="line">	I2C_SendByte(WordAddress);</span><br><span class="line">	I2C_ReceiveAck();</span><br><span class="line">	I2C_Start();</span><br><span class="line">	I2C_SendByte(AT24C02_ADDRESS|<span class="number">0x01</span>);</span><br><span class="line">	I2C_ReceiveAck();</span><br><span class="line">	Data=I2C_ReceiveByte();</span><br><span class="line">	I2C_SendAck(<span class="number">1</span>);</span><br><span class="line">	I2C_Stop();</span><br><span class="line">	<span class="keyword">return</span> Data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="十三-DS18B20温度传感器"><a href="#十三-DS18B20温度传感器" class="headerlink" title="十三.DS18B20温度传感器"></a>十三.DS18B20温度传感器</h1><h2 id="13-1-DS18B20"><a href="#13-1-DS18B20" class="headerlink" title="13.1 DS18B20"></a>13.1 DS18B20</h2><p>DS18B20是一种常见的数字温度传感器，其控制命令和数据都是以数字信号的方式输入输出，相比较于模拟温度传感器，具有功能强大、硬件简单、易扩展、抗干扰性强等特点。</p>
<p>测温范围：-55°C 到 +125°C。</p>
<p>通信接口：1-Wire（单总线）。</p>
<p>其它特征：可形成总线结构、内置温度报警功能、可寄生供电。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS18B20.png" alt="DS18B20"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS18B20%E5%BC%95%E8%84%9A%E5%8F%8A%E9%A9%B1%E5%8A%A8%E7%94%B5%E8%B7%AF.png" alt="DS18B20引脚及驱动电路"></p>
<h2 id="13-2单总线介绍"><a href="#13-2单总线介绍" class="headerlink" title="13.2单总线介绍"></a>13.2单总线介绍</h2><p>单总线（1-Wire BUS）是由Dallas公司开发的一种通用数据总线。</p>
<p>一根通信线：DQ。</p>
<p>异步、半双工。</p>
<p>单总线只需要一根通信线即可实现数据的双向传输，当采用寄生供电时，还可以省去设备的VDD线路，此时，供电加通信只需要DQ和GND两根线。</p>
<h2 id="13-3单总线电路规范"><a href="#13-3单总线电路规范" class="headerlink" title="13.3单总线电路规范"></a>13.3单总线电路规范</h2><p>设备的DQ均要配置成开漏输出模式。</p>
<p>DQ添加一个上拉电阻，阻值一般为4.7KΩ左右。</p>
<p>若此总线的从机采取寄生供电，则主机还应配一个强上拉输出电路。</p>
<h2 id="13-4单总线时序结构"><a href="#13-4单总线时序结构" class="headerlink" title="13.4单总线时序结构"></a>13.4单总线时序结构</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8D%95%E6%80%BB%E7%BA%BF%E5%88%9D%E5%A7%8B%E5%8C%96.png" alt="单总线初始化"></p>
<p>![单总线 发送一位](..&#x2F;images&#x2F;51单片机学习笔记&#x2F;单总线 发送一位.png)</p>
<p>![单总线 接收一位](..&#x2F;images&#x2F;51单片机学习笔记&#x2F;单总线 接收一位.png)</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%8D%95%E6%80%BB%E7%BA%BF%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6%E4%B8%80%E4%B8%AA%E5%AD%97%E8%8A%82.png" alt="单总线发送接收一个字节"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS18B20%E6%93%8D%E4%BD%9C%E6%B5%81%E7%A8%8B.png" alt="DS18B20操作流程"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DS18B20%E6%95%B0%E6%8D%AE%E5%B8%A7.png" alt="DS18B20数据帧"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%B8%A9%E5%BA%A6%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F.png" alt="温度存储格式"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit OneWire_DQ=P3^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">OneWire_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> AckBit;</span><br><span class="line">	EA=<span class="number">0</span>;</span><br><span class="line">	OneWire_DQ=<span class="number">1</span>;</span><br><span class="line">	OneWire_DQ=<span class="number">0</span>;</span><br><span class="line">	i = <span class="number">247</span>;<span class="keyword">while</span> (--i);		<span class="comment">//Delay 500us</span></span><br><span class="line">	OneWire_DQ=<span class="number">1</span>;</span><br><span class="line">	i = <span class="number">32</span>;<span class="keyword">while</span> (--i);			<span class="comment">//Delay 70us</span></span><br><span class="line">	AckBit=OneWire_DQ;</span><br><span class="line">	i = <span class="number">247</span>;<span class="keyword">while</span> (--i);		<span class="comment">//Delay 500us</span></span><br><span class="line">	EA=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> AckBit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">OneWire_SendBit</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Bit)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	EA=<span class="number">0</span>;</span><br><span class="line">	OneWire_DQ=<span class="number">0</span>;</span><br><span class="line">	i = <span class="number">4</span>;<span class="keyword">while</span> (--i);			<span class="comment">//Delay 10us</span></span><br><span class="line">	OneWire_DQ=Bit;</span><br><span class="line">	i = <span class="number">24</span>;<span class="keyword">while</span> (--i);			<span class="comment">//Delay 50us</span></span><br><span class="line">	OneWire_DQ=<span class="number">1</span>;</span><br><span class="line">	EA=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">OneWire_ReceiveBit</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> Bit;</span><br><span class="line">	EA=<span class="number">0</span>;</span><br><span class="line">	OneWire_DQ=<span class="number">0</span>;</span><br><span class="line">	i = <span class="number">2</span>;<span class="keyword">while</span> (--i);			<span class="comment">//Delay 5us</span></span><br><span class="line">	OneWire_DQ=<span class="number">1</span>;</span><br><span class="line">	i = <span class="number">2</span>;<span class="keyword">while</span> (--i);			<span class="comment">//Delay 5us</span></span><br><span class="line">	Bit=OneWire_DQ;</span><br><span class="line">	i = <span class="number">24</span>;<span class="keyword">while</span> (--i);			<span class="comment">//Delay 50us</span></span><br><span class="line">	EA=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> Bit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">OneWire_SendByte</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Byte)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		OneWire_SendBit(Byte&amp;(<span class="number">0x01</span>&lt;&lt;i));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">OneWire_ReceiveByte</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> Byte=<span class="number">0x00</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(OneWire_ReceiveBit())&#123;Byte|=(<span class="number">0x01</span>&lt;&lt;i);&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Byte;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="十四-LCD1602"><a href="#十四-LCD1602" class="headerlink" title="十四.LCD1602"></a>十四.LCD1602</h1><h2 id="14-1LCD1602概述"><a href="#14-1LCD1602概述" class="headerlink" title="14.1LCD1602概述"></a>14.1LCD1602概述</h2><p>LCD1602（Liquid Crystal Display）液晶显示屏是一种字符型液晶显示模块，可以显示ASCII码的标准字符和其它的一些内置特殊字符，还可以有8个自定义字符。</p>
<p>显示容量：16×2个字符，每个字符为5*7点阵。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%B8%B8%E8%A7%81%E6%B6%B2%E6%99%B6%E6%98%BE%E7%A4%BA%E5%B1%8F.png" alt="常见液晶显示屏"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/LCD1602%E5%BC%95%E8%84%9A%E5%8F%8A%E9%A9%B1%E5%8A%A8%E7%94%B5%E8%B7%AF.png" alt="LCD1602引脚及驱动电路"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/LCD1602%E5%86%85%E9%83%A8%E7%BB%93%E6%9E%84%E5%9B%BE.png" alt="LCD1602内部结构图"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/LCD1602%E5%86%85%E9%83%A8RAM%E6%98%A0%E5%B0%84%E5%9B%BE.png" alt="LCD1602内部RAM映射图"></p>
<p>​        当我们向图中的00～0F、40<del>4F地址中的任一处写入显示数据时，液晶都可立即显示出来，当写入到10</del>27或50~67地址处时，必须通过移屏指令将它们移入可显示区域方可正常显示。</p>
<h2 id="14-2时序结构"><a href="#14-2时序结构" class="headerlink" title="14.2时序结构"></a>14.2时序结构</h2><p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/LCD1602%E5%86%99%E6%95%B0%E6%8D%AE%E6%88%96%E6%8C%87%E4%BB%A4.png" alt="LCD1602写数据或指令"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/LCD1602%E5%AD%97%E7%AC%A6%E5%9E%8B%E6%B6%B2%E6%99%B6%E6%98%BE%E7%A4%BA%E6%A8%A1%E5%9D%97%E6%8C%87%E4%BB%A4%E9%9B%86.png" alt="LCD1602字符型液晶显示模块指令集"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/LCD1602%E6%93%8D%E4%BD%9C%E6%B5%81%E7%A8%8B.png" alt="LCD1602操作流程"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LCD_RS=P2^<span class="number">6</span>;</span><br><span class="line">sbit LCD_RW=P2^<span class="number">5</span>;</span><br><span class="line">sbit LCD_E=P2^<span class="number">7</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LCD_DataPort P0</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_Delay</span><span class="params">()</span>		<span class="comment">//@12.000MHz 1ms</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line"></span><br><span class="line">	i = <span class="number">2</span>;</span><br><span class="line">	j = <span class="number">239</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_WriteCommand</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Command)</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_RS=<span class="number">0</span>;</span><br><span class="line">	LCD_RW=<span class="number">0</span>;</span><br><span class="line">	LCD_DataPort=Command;</span><br><span class="line">	LCD_E=<span class="number">1</span>;</span><br><span class="line">	LCD_Delay();</span><br><span class="line">	LCD_E=<span class="number">0</span>;</span><br><span class="line">	LCD_Delay();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_WriteData</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Data)</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_RS=<span class="number">1</span>;</span><br><span class="line">	LCD_RW=<span class="number">0</span>;</span><br><span class="line">	LCD_DataPort=Data;</span><br><span class="line">	LCD_E=<span class="number">1</span>;</span><br><span class="line">	LCD_Delay();</span><br><span class="line">	LCD_E=<span class="number">0</span>;</span><br><span class="line">	LCD_Delay();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_Init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_WriteCommand(<span class="number">0x38</span>);</span><br><span class="line">	LCD_WriteCommand(<span class="number">0x0C</span>);</span><br><span class="line">	LCD_WriteCommand(<span class="number">0x06</span>);</span><br><span class="line">	LCD_WriteCommand(<span class="number">0x01</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_SetCursor</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(Line==<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteCommand(<span class="number">0x80</span>|(Column<span class="number">-1</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteCommand(<span class="number">0x80</span>|(Column<span class="number">-1</span>)+<span class="number">0x40</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_ShowChar</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column,<span class="type">unsigned</span> <span class="type">char</span> Char)</span></span><br><span class="line">&#123;</span><br><span class="line">	LCD_SetCursor(Line,Column);</span><br><span class="line">	LCD_WriteData(Char);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_ShowString</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column,<span class="type">unsigned</span> <span class="type">char</span> *String)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	LCD_SetCursor(Line,Column);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;String[i]!=<span class="string">&#x27;\0&#x27;</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteData(String[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">LCD_Pow</span><span class="params">(<span class="type">int</span> X,<span class="type">int</span> Y)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">int</span> Result=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;Y;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		Result*=X;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> Result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_ShowNum</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column,<span class="type">unsigned</span> <span class="type">int</span> Number,<span class="type">unsigned</span> <span class="type">char</span> Length)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	LCD_SetCursor(Line,Column);</span><br><span class="line">	<span class="keyword">for</span>(i=Length;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteData(<span class="string">&#x27;0&#x27;</span>+Number/LCD_Pow(<span class="number">10</span>,i<span class="number">-1</span>)%<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_ShowSignedNum</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column,<span class="type">int</span> Number,<span class="type">unsigned</span> <span class="type">char</span> Length)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> Number1;</span><br><span class="line">	LCD_SetCursor(Line,Column);</span><br><span class="line">	<span class="keyword">if</span>(Number&gt;=<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteData(<span class="string">&#x27;+&#x27;</span>);</span><br><span class="line">		Number1=Number;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteData(<span class="string">&#x27;-&#x27;</span>);</span><br><span class="line">		Number1=-Number;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=Length;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteData(<span class="string">&#x27;0&#x27;</span>+Number1/LCD_Pow(<span class="number">10</span>,i<span class="number">-1</span>)%<span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_ShowHexNum</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column,<span class="type">unsigned</span> <span class="type">int</span> Number,<span class="type">unsigned</span> <span class="type">char</span> Length)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> SingleNumber;</span><br><span class="line">	LCD_SetCursor(Line,Column);</span><br><span class="line">	<span class="keyword">for</span>(i=Length;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">	&#123;</span><br><span class="line">		SingleNumber=Number/LCD_Pow(<span class="number">16</span>,i<span class="number">-1</span>)%<span class="number">16</span>;</span><br><span class="line">		<span class="keyword">if</span>(SingleNumber&lt;<span class="number">10</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			LCD_WriteData(<span class="string">&#x27;0&#x27;</span>+SingleNumber);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			LCD_WriteData(<span class="string">&#x27;A&#x27;</span>+SingleNumber<span class="number">-10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LCD_ShowBinNum</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Line,<span class="type">unsigned</span> <span class="type">char</span> Column,<span class="type">unsigned</span> <span class="type">int</span> Number,<span class="type">unsigned</span> <span class="type">char</span> Length)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	LCD_SetCursor(Line,Column);</span><br><span class="line">	<span class="keyword">for</span>(i=Length;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">	&#123;</span><br><span class="line">		LCD_WriteData(<span class="string">&#x27;0&#x27;</span>+Number/LCD_Pow(<span class="number">2</span>,i<span class="number">-1</span>)%<span class="number">2</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="十五-直流电机驱动PWM"><a href="#十五-直流电机驱动PWM" class="headerlink" title="十五.直流电机驱动PWM"></a>十五.直流电机驱动PWM</h1><h2 id="15-1概述"><a href="#15-1概述" class="headerlink" title="15.1概述"></a>15.1概述</h2><p>​        直流电机是一种将电能转换为机械能的装置。一般的直流电机有两个电极，当电极正接时，电机正转，当电极反接时，电机反转。</p>
<p>​        直流电机主要由永磁体（定子）、线圈（转子）和换向器组成。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E7%94%B5%E8%B7%AF.png" alt="电机驱动电路"></p>
<h2 id="15-2PWM介绍"><a href="#15-2PWM介绍" class="headerlink" title="15.2PWM介绍"></a>15.2PWM介绍</h2><p>​        PWM（Pulse Width Modulation）即脉冲宽度调制，在具有惯性的系统中，可以通过对一系列脉冲的宽度进行调制，来等效地获得所需要的模拟参量，常应用于电机控速、开关电源等领域。</p>
<p>PWM重要参数：</p>
<p>​        频率 &#x3D; 1 &#x2F; TS      占空比 &#x3D; TON &#x2F; TS      精度 &#x3D; 占空比变化步距。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//LED呼吸灯</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED=P2^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">while</span>(t--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> Time,i;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(Time=<span class="number">0</span>;Time&lt;<span class="number">100</span>;Time++)		</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)			</span><br><span class="line">			&#123;</span><br><span class="line">				LED=<span class="number">0</span>;					</span><br><span class="line">				Delay(Time);			</span><br><span class="line">				LED=<span class="number">1</span>;					</span><br><span class="line">				Delay(<span class="number">100</span>-Time);		</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(Time=<span class="number">100</span>;Time&gt;<span class="number">0</span>;Time--)		</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">20</span>;i++)			</span><br><span class="line">			&#123;</span><br><span class="line">				LED=<span class="number">0</span>;					</span><br><span class="line">				Delay(Time);			</span><br><span class="line">				LED=<span class="number">1</span>;					</span><br><span class="line">				Delay(<span class="number">100</span>-Time);		</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E4%BA%A7%E7%94%9FPWM%E6%96%B9%E6%B3%95.png" alt="产生PWM方法"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Delay.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Key.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Nixie.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Timer0.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit Motor=P1^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> Counter,Compare;	</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum,Speed;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	Timer0_Init();</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		KeyNum=Key();</span><br><span class="line">		<span class="keyword">if</span>(KeyNum==<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			Speed++;</span><br><span class="line">			Speed%=<span class="number">4</span>;</span><br><span class="line">			<span class="keyword">if</span>(Speed==<span class="number">0</span>)&#123;Compare=<span class="number">0</span>;&#125;	</span><br><span class="line">			<span class="keyword">if</span>(Speed==<span class="number">1</span>)&#123;Compare=<span class="number">50</span>;&#125;</span><br><span class="line">			<span class="keyword">if</span>(Speed==<span class="number">2</span>)&#123;Compare=<span class="number">75</span>;&#125;</span><br><span class="line">			<span class="keyword">if</span>(Speed==<span class="number">3</span>)&#123;Compare=<span class="number">100</span>;&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Timer0_Routine</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123;</span><br><span class="line">	TL0 = <span class="number">0x9C</span>;		</span><br><span class="line">	TH0 = <span class="number">0xFF</span>;		</span><br><span class="line">	Counter++;</span><br><span class="line">	Counter%=<span class="number">100</span>;	</span><br><span class="line">	<span class="keyword">if</span>(Counter&lt;Compare)	</span><br><span class="line">	&#123;</span><br><span class="line">		Motor=<span class="number">1</span>;		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>				</span><br><span class="line">	&#123;</span><br><span class="line">		Motor=<span class="number">0</span>;		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="十六-A-x2F-D-D-x2F-A"><a href="#十六-A-x2F-D-D-x2F-A" class="headerlink" title="十六.A&#x2F;D  D&#x2F;A"></a>十六.A&#x2F;D  D&#x2F;A</h1><h2 id="16-1概述"><a href="#16-1概述" class="headerlink" title="16.1概述"></a>16.1概述</h2><p>AD（Analog to Digital）：模拟-数字转换，将模拟信号转换为计算机可操作的数字信号。</p>
<p>DA（Digital to Analog）：数字-模拟转换，将计算机输出的数字信号转换为模拟信号。</p>
<p>AD&#x2F;DA转换打开了计算机与模拟信号的大门，极大的提高了计算机系统的应用范围，也为模拟信号数字化处理提供了可能。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%A1%AC%E4%BB%B6%E7%94%B5%E8%B7%AF%E6%A8%A1%E5%9E%8B.png" alt="硬件电路模型"></p>
<p>AD转换通常有多个输入通道，用多路选择开关连接至AD转换器，以实现AD多路复用的目的，提高硬件利用率。</p>
<p>AD&#x2F;DA与单片机数据传送可使用并口（速度快、原理简单），也可使用串口（接线少、使用方便）。</p>
<p>可将AD&#x2F;DA模块直接集成在单片机内，这样直接写入&#x2F;读出寄存器就可进行AD&#x2F;DA转换，单片机的IO口可直接复用为AD&#x2F;DA的通道。</p>
<p>![AD DA](..&#x2F;images&#x2F;51单片机学习笔记&#x2F;AD DA.png)</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/DA%E5%8E%9F%E7%90%86.png" alt="DA原理"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/AD%E5%8E%9F%E7%90%86.png" alt="AD原理"></p>
<h2 id="16-2性能指标"><a href="#16-2性能指标" class="headerlink" title="16.2性能指标"></a>16.2性能指标</h2><p>分辨率：指AD&#x2F;DA数字量的精细程度，通常用位数表示。例如，对于5V电源系统来说，8位的AD可将5V等分为256份，即数字量变化最小一个单位时，模拟量变化5V&#x2F;256&#x3D;0.01953125V，所以，8位AD的电压分辨率为0.01953125V，AD&#x2F;DA的位数越高，分辨率就越高。</p>
<p>转换速度：表示AD&#x2F;DA的最大采样&#x2F;建立频率，通常用转换频率或者转换时间来表示，对于采样&#x2F;输出高速信号，应注意AD&#x2F;DA的转换速度。</p>
<h2 id="16-3-XPT2046"><a href="#16-3-XPT2046" class="headerlink" title="16.3 XPT2046"></a>16.3 XPT2046</h2><p>​         XPT2046是一款4线制电阻式触摸屏控制器，内含12位分辨率125KHz转换速率逐步逼近型A&#x2F;D转换器。XPT2046支持从1.5V到5.25V的低电压I&#x2F;0接口。XPT2046能通过执行两次A&#x2F;D转换查出被按的屏幕位置，除此之外，还可以测量加在触摸屏上的压力。内部自带⒉2.5V参考电压，可以作为辅助输入、温度测量和电池监测之用，电池监测的电压范围可以从O0V到6V。XPT2046片内集成有一个温度传感器。在2.7V的典型工作状态下，关闭参考电压，功耗可小于0.75mW。XPT2046采用微小的封装形式:TSSOP-16,QFN-16和VFBGA一48。工作温度范围为-40℃～+85℃。与ADS7846、TSC2046、AK4182A完全兼容。</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/XPT2046%E6%97%B6%E5%BA%8F.png" alt="XPT2046时序"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;INTRINS.H&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit XPY2046_DIN=P3^<span class="number">4</span>;</span><br><span class="line">sbit XPY2046_CS=P3^<span class="number">5</span>;</span><br><span class="line">sbit XPY2046_DCLK=P3^<span class="number">6</span>;</span><br><span class="line">sbit XPY2046_DOUT=P3^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">XPT2046_ReadAD</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Command)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> Data=<span class="number">0</span>;</span><br><span class="line">	XPY2046_DCLK=<span class="number">0</span>;</span><br><span class="line">	XPY2046_CS=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		XPY2046_DIN=Command&amp;(<span class="number">0x80</span>&gt;&gt;i);</span><br><span class="line">		XPY2046_DCLK=<span class="number">1</span>;</span><br><span class="line">		XPY2046_DCLK=<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">16</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		XPY2046_DCLK=<span class="number">1</span>;</span><br><span class="line">		XPY2046_DCLK=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(XPY2046_DOUT)&#123;Data|=(<span class="number">0x8000</span>&gt;&gt;i);&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	XPY2046_CS=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> Data&gt;&gt;<span class="number">8</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="十七-红外遥控（外部中断）"><a href="#十七-红外遥控（外部中断）" class="headerlink" title="十七.红外遥控（外部中断）"></a>十七.红外遥控（外部中断）</h1><h2 id="17-1概述"><a href="#17-1概述" class="headerlink" title="17.1概述"></a>17.1概述</h2><p>红外遥控是利用红外光进行通信的设备，由红外LED将调制后的信号发出，由专用的红外接收头进行解调输出</p>
<p>通信方式：单工，异步</p>
<p>红外LED波长：940nm</p>
<p>通信协议标准：NEC标准</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E7%BA%A2%E5%A4%96%E9%81%A5%E6%8E%A7%E7%A1%AC%E4%BB%B6%E7%94%B5%E8%B7%AF.png" alt="红外遥控硬件电路"></p>
<p>•空闲状态：红外LED不亮，接收头输出高电平</p>
<p>•发送低电平：红外LED以38KHz频率闪烁发光，接收头输出低电平</p>
<p>•发送高电平：红外LED不亮，接收头输出高电平</p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E5%9F%BA%E6%9C%AC%E5%8F%91%E9%80%81%E4%B8%8E%E6%8E%A5%E6%94%B6.png" alt="基本发送与接收"></p>
<p><img src="/../images/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/NEC%E7%BC%96%E7%A0%81.png" alt="NEC编码"></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">RickyLove</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://rickylove67.github.io/2023/01/19/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">http://rickylove67.github.io/2023/01/19/51%E5%8D%95%E7%89%87%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">RickyLove</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/01/19/%E8%AF%97%E8%AF%8D%E7%95%99%E5%BF%B5/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="诗词留念">
                        
                        <span class="card-title">诗词留念</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-01-19
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            RickyLove
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/01/10/TRIZ%E5%88%9B%E6%96%B0%E7%90%86%E8%AE%BA%E5%AD%A6%E4%B9%A0/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="TRIZ创新理论学习">
                        
                        <span class="card-title">TRIZ创新理论学习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-01-10
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            RickyLove
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>



<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2020-2024</span>
            
            <a href="/about" target="_blank">RickyLove</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
            
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/RickyLove67" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:839351467@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>


<!-- 

 -->


    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=839351467" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 839351467" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>


<!-- 




    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>
 -->
</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

    <!--浏览器搞笑标题-->
    <script type="text/javascript" src="/js/FunnyTitle.js"></script>

</body>

</html>
